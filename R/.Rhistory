Share_YN_Food<-ifelse(runif(1)<Pr_share_Food,1,0)
#Fruit
#Items in Share Table:
if(Pick_YN_Fr==1){
if(Fr_Data.Frame[Fr_Picked,colnames(Fr_Data.Frame)=="Location"]== "Not Consumed"){
if(Share_YN_Food==1){
Fr_Data.Frame[Fr_Picked,colnames(Fr_Data.Frame)== "Location"]<-"Shared"
Fr_Data.Frame[Fr_Picked,colnames(Fr_Data.Frame)=="History"]<-paste(Fr_Data.Frame[Fr_Picked,colnames(Fr_Data.Frame)=="History"], "Shared")
Fr_Data.Frame[Fr_Picked,colnames(Fr_Data.Frame)=="STtimes"]<-Func_Index_DF(Fr_Data.Frame,Fr_Picked,"STtimes")+1
V_Shared_Fr<-(V_Shared_Fr+1)
}else{
Fr_Data.Frame[Fr_Picked,colnames(Fr_Data.Frame)== "Location"]<-"Not Shared"
Fr_Data.Frame[Fr_Picked,colnames(Fr_Data.Frame)=="History"]<-paste(Fr_Data.Frame[Fr_Picked,colnames(Fr_Data.Frame)=="History"], "NotShared")
}
}
}
#Pss
if(Pick_YN_Pss==1){
if(Pss_Data.Frame[Pss_Picked,colnames(Pss_Data.Frame)=="Location"]== "Not Consumed"){
if(Share_YN_Food==1){
Pss_Data.Frame[Pss_Picked,colnames(Pss_Data.Frame)== "Location"]<-"Shared"
Pss_Data.Frame[Pss_Picked,colnames(Pss_Data.Frame)=="History"]<-paste(Pss_Data.Frame[Pss_Picked,colnames(Pss_Data.Frame)=="History"], "Shared")
Pss_Data.Frame[Pss_Picked,colnames(Pss_Data.Frame)=="STtimes"]<-Func_Index_DF(Pss_Data.Frame,Pss_Picked,"STtimes")+1
V_Shared_Pss<-(V_Shared_Pss+1)
}else{
Pss_Data.Frame[Pss_Picked,colnames(Pss_Data.Frame)== "Location"]<-"Not Shared"
Pss_Data.Frame[Pss_Picked,colnames(Pss_Data.Frame)=="History"]<-paste(Pss_Data.Frame[Pss_Picked,colnames(Pss_Data.Frame)=="History"], "NotShared")
}
}
}
#Pre
if(Pick_YN_Pre==1){
if(Pre_Data.Frame[Pre_Picked,colnames(Pre_Data.Frame)=="Location"]== "Not Consumed"){
if(Share_YN_Food==1){
Pre_Data.Frame[Pre_Picked,colnames(Pre_Data.Frame)== "Location"]<-"Shared"
Pre_Data.Frame[Pre_Picked,colnames(Pre_Data.Frame)=="History"]<-paste(Pre_Data.Frame[Pre_Picked,colnames(Pre_Data.Frame)=="History"], "Shared")
Pre_Data.Frame[Pre_Picked,colnames(Pre_Data.Frame)=="STtimes"]<-Func_Index_DF(Pre_Data.Frame,Pre_Picked,"STtimes")+1
V_Shared_Pre<-(V_Shared_Pre+1)
}else{
Pre_Data.Frame[Pre_Picked,colnames(Pre_Data.Frame)== "Location"]<-" Not Shared"
Pre_Data.Frame[Pre_Picked,colnames(Pre_Data.Frame)=="History"]<-paste(Pre_Data.Frame[Pre_Picked,colnames(Pre_Data.Frame)=="History"], "NotShared")
}
}
}
#Picking and consuming ST items ==================================================================
#Shared Fruit
Items_Shared<-Fr_Data.Frame$Location == "Shared"
Sum_Shared<-sum(Items_Shared, na.rm = TRUE)
if(Sum_Shared>0){
#Fruit
#Did a student pick an item for the share table?
Pick_ST_YN_Fr<-ifelse(runif(1)<Pr_Pick_ST_Fr,1,0)
#Fruit picked from Share Table.
if(Pick_ST_YN_Fr==1){
Search.df.fr_ST<-Func_Search_Data(Fr_Data.Frame,Fr_Data.Frame$Location,"Shared",1)
#Fruit from share table selected #
Fr_ST_Picked<-as.numeric(Search.df.fr_ST$Item.No.)
Fr_Data.Frame[as.numeric(row.names(Search.df.fr_ST)),colnames(Search.df.fr_ST)== "Location"]<-"Tray"
Fr_Data.Frame[Fr_ST_Picked,colnames(Fr_Data.Frame)=="History"]<-paste(Fr_Data.Frame[Fr_ST_Picked,colnames(Fr_Data.Frame)=="History"], "Tray")
Fr_Data.Frame[Fr_ST_Picked,colnames(Fr_Data.Frame)=="History"]<-paste(Fr_Data.Frame[Fr_ST_Picked,colnames(Fr_Data.Frame)=="History"], "Touched")
}
#Contamination from Hand to Fruit or from Fruit to Hand.
if(Pick_ST_YN_Fr==1){
#Contamination from picking item share table
Func_Cross_Contamination(Cont_Student=Cont_Student,Data.Frame=Fr_Data.Frame, Item_Picked= Fr_ST_Picked, Item="Fruit")
Fr_Data.Frame<-Func_Allergen_CC(Fr_Data.Frame,Fr_ST_Picked) #Adding Allergen Contamination
}
#Consumption of share table item
#Did the student consume the Fruit?
Eat_YN_ST_Fr<-ifelse(runif(1)<Pr_eat_ST_Fr,1,0)
#Changing Data Frame so it updates when student consumes fruit.
if(Pick_ST_YN_Fr==1){
if(Eat_YN_ST_Fr==1){
Fr_Data.Frame[Fr_ST_Picked,colnames(Fr_Data.Frame)== "Location"]<-"Consumed"
Fr_Data.Frame[Fr_ST_Picked,colnames(Fr_Data.Frame)== "ConsumedBy"]<-(paste(l,k,j,z))
Fr_Data.Frame[Fr_ST_Picked,colnames(Fr_Data.Frame)=="History"]<-paste(Fr_Data.Frame[Fr_ST_Picked,colnames(Fr_Data.Frame)=="History"], "Consumed")
#Contamination
if (Wrapping_Apples == 1){
#Cross Contamination at consumption if apples wrapped
Func_Cross_Contamination_Consumption_Wrapped(Cont_Student = Cont_Student,Data.Frame = Fr_Data.Frame,Item_Picked = Fr_ST_Picked ,Item = "Fruit")
Fr_Data.Frame<-Func_Allergen_CC(Fr_Data.Frame,Fr_ST_Picked) #Adding Allergen Contamination from touch.
} else if (Wrapping_Apples == 0){
#Cross Contamination @ Consumption apples not wrapped.
Func_Cross_Contamination(Cont_Student=Cont_Student,Data.Frame=Fr_Data.Frame, Item_Picked= Fr_ST_Picked, Item="Fruit")
} #end of if wrapp
}else{
Fr_Data.Frame[Fr_ST_Picked,colnames(Fr_Data.Frame)== "Location"]<-"Not Consumed"
Fr_Data.Frame[Fr_ST_Picked,colnames(Fr_Data.Frame)=="History"]<-paste(Fr_Data.Frame[Fr_ST_Picked,colnames(Fr_Data.Frame)=="History"], "NotConsumed")
#Cross Crontamination from apples not consumed from ST
Func_Cross_Contamination(Cont_Student=Cont_Student,Data.Frame=Fr_Data.Frame, Item_Picked= Fr_ST_Picked, Item="Fruit")
Fr_Data.Frame<-Func_Allergen_CC(Fr_Data.Frame,Fr_ST_Picked) #Adding Allergen Contamination from touch.
} #end of eat if
} # end of picking if
}  #end of if to make sure there are ST items
#Shared Pss
Items_Shared_Pss<-Pss_Data.Frame$Location == "Shared"
Sum_Shared_Pss<-sum(Items_Shared_Pss, na.rm = TRUE)
if(Sum_Shared_Pss>0){
#Did a student pick an item for the share table?
Pick_ST_YN_Pss<-ifelse(runif(1)<Pr_Pick_ST_Pss,1,0)
#Pss picked from Share Table.
if(Pick_ST_YN_Pss==1){
Search.df.Pss_ST<-Func_Search_Data(Pss_Data.Frame,Pss_Data.Frame$Location,"Shared",1)
#Pss from share table selected #
Pss_ST_Picked<-as.numeric(Search.df.Pss_ST$Item.No.)
Pss_Data.Frame[as.numeric(row.names(Search.df.Pss_ST)),colnames(Search.df.Pss_ST)== "Location"]<-"Tray"
Pss_Data.Frame[Pss_ST_Picked,colnames(Pss_Data.Frame)=="History"]<-paste(Pss_Data.Frame[Pss_ST_Picked,colnames(Pss_Data.Frame)=="History"], "Tray")
Pss_Data.Frame[Pss_ST_Picked,colnames(Pss_Data.Frame)=="History"]<-paste(Pss_Data.Frame[Pss_ST_Picked,colnames(Pss_Data.Frame)=="History"], "Touched")
}
#Contamination from Hand to Pss or from Hand to Pss.
if(Pick_ST_YN_Pss==1){
#Contamination at tray
Func_Cross_Contamination(Cont_Student=Cont_Student,Data.Frame=Pss_Data.Frame, Item_Picked= Pss_ST_Picked, Item="PSS")
Pss_Data.Frame<-Func_Allergen_CC(Pss_Data.Frame,Pss_ST_Picked) #Adding Allergen Contamination
}
#Consumption of share table item
#Did the student consume the Fruit?
Eat_YN_ST_Pss<-ifelse(runif(1)<Pr_eat_ST_Pss,1,0)
#Changing Data Frame so it updates when student consumes fruit.
if(Pick_ST_YN_Pss==1){
if(Eat_YN_ST_Pss==1){
Pss_Data.Frame[Pss_ST_Picked,colnames(Pss_Data.Frame)== "Location"]<-"Consumed"
Pss_Data.Frame[Pss_ST_Picked,colnames(Pss_Data.Frame)== "ConsumedBy"]<-(paste(l,k,j,z))
Pss_Data.Frame[Pss_ST_Picked,colnames(Pss_Data.Frame)=="History"]<-paste(Pss_Data.Frame[Pss_ST_Picked,colnames(Pss_Data.Frame)=="History"], "Consumed")
#Cross Contamination @ Consumption
Func_Cross_Contamination_Consumption_Wrapped(Cont_Student = Cont_Student,Data.Frame = Pss_Data.Frame,Item_Picked = Pss_ST_Picked,Item = "PSS")
Pss_Data.Frame<-Func_Allergen_CC(Pss_Data.Frame,Pss_ST_Picked) #Adding Allergen Contamination from touch.
}else{
Pss_Data.Frame[Pss_ST_Picked,colnames(Pss_Data.Frame)== "Location"]<-"Not Consumed"
Pss_Data.Frame[Pss_ST_Picked,colnames(Pss_Data.Frame)=="History"]<-paste(Pss_Data.Frame[Pss_ST_Picked,colnames(Pss_Data.Frame)=="History"], "NotConsumed")
#Contamination from Touch @ Not Consumption
Func_Cross_Contamination(Cont_Student=Cont_Student,Data.Frame=Pss_Data.Frame, Item_Picked= Pss_ST_Picked, Item="PSS")
Pss_Data.Frame<-Func_Allergen_CC(Pss_Data.Frame,Pss_ST_Picked) #Adding Allergen Contamination from touch.
}
}
}
#Shared Pre
Items_Shared_Pre<-Pre_Data.Frame$Location == "Shared"
Sum_Shared_Pre<-sum(Items_Shared_Pre, na.rm = TRUE)
if(Sum_Shared_Pre>0){
#Did a student pick an item for the share table?
Pick_ST_YN_Pre<-ifelse(runif(1)<Pr_Pick_ST_Pre,1,0)
#Pre picked from Share Table.
if(Pick_ST_YN_Pre==1){
Search.df.Pre_ST<-Func_Search_Data(Pre_Data.Frame,Pre_Data.Frame$Location,"Shared",1)
#Pre from share table selected #
Pre_ST_Picked<-as.numeric(Search.df.Pre_ST$Item.No.)
Pre_Data.Frame[as.numeric(row.names(Search.df.Pre_ST)),colnames(Search.df.Pre_ST)== "Location"]<-"Tray"
Pre_Data.Frame[Pre_ST_Picked,colnames(Pre_Data.Frame)=="History"]<-paste(Pre_Data.Frame[Pre_ST_Picked,colnames(Pre_Data.Frame)=="History"], "Tray")
Pre_Data.Frame[Pre_ST_Picked,colnames(Pre_Data.Frame)=="History"]<-paste(Pre_Data.Frame[Pre_ST_Picked,colnames(Pre_Data.Frame)=="History"], "Touched")
}
#Contamination from Hand to Fruit or from Hand to Fruit.
if(Pick_ST_YN_Pre==1){
Func_Cross_Contamination(Cont_Student=Cont_Student,Data.Frame=Pre_Data.Frame, Item_Picked= Pre_ST_Picked, Item="PRE")
Pre_Data.Frame<-Func_Allergen_CC(Pre_Data.Frame,Pre_ST_Picked) #Adding Allergen Contamination
}
#Consumption of share table item
#Did the student consume the Fruit?
Eat_YN_ST_Pre<-ifelse(runif(1)<Pr_eat_ST_Pre,1,0)
#Changing Data Frame so it updates when student consumes fruit.
if(Pick_ST_YN_Pre==1){
if(Eat_YN_ST_Pre==1){
#Updating Values in DF
Pre_Data.Frame[Pre_ST_Picked,colnames(Pre_Data.Frame)== "Location"]<-"Consumed"
Pre_Data.Frame[Pre_ST_Picked,colnames(Pre_Data.Frame)== "ConsumedBy"]<-(paste(l,k,j,z))
Pre_Data.Frame[Pre_ST_Picked,colnames(Pre_Data.Frame)=="History"]<-paste(Pre_Data.Frame[Pre_ST_Picked,colnames(Pre_Data.Frame)=="History"], "Consumed")
#Contamination Container Pre to Mouth @ Consumption
Func_Cross_Contamination_Pre_Consumption(Cont_Student = Cont_Student, Pre_Data.Frame = Pre_Data.Frame, Pre_Picked = Pre_ST_Picked)
Pre_Data.Frame<-Func_Allergen_CC(Pre_Data.Frame,Pre_ST_Picked) #Adding Allergen Contamination from touch.
}else{
Pre_Data.Frame[Pre_ST_Picked,colnames(Pre_Data.Frame)== "Location"]<-"Not Consumed"
Pre_Data.Frame[Pre_ST_Picked,colnames(Pre_Data.Frame)=="History"]<-paste(Pre_Data.Frame[Pre_ST_Picked,colnames(Pre_Data.Frame)=="History"], "NotConsumed")
#Contaminationat Pre Container
Func_Cross_Contamination(Cont_Student=Cont_Student,Data.Frame=Pre_Data.Frame, Item_Picked= Pre_ST_Picked, Item="PRE")
Pre_Data.Frame<-Func_Allergen_CC(Pre_Data.Frame,Pre_ST_Picked) #Adding Allergen Contamination from touch.
}
}
}#end of if there is st items loop
}#end of toggle loop
}  #end of first loop
#Updated items from not consumed, not shared, etc to wasted.
Fr_Data.Frame$Location[Fr_Data.Frame$Location=="Not Shared"]<-"Discarded"
Fr_Data.Frame$Location[Fr_Data.Frame$Location=="Not Consumed"]<-"Discarded"
if(Reservice_YN==0){
Fr_Data.Frame$Location[Fr_Data.Frame$Location=="Selection Table"]<-"Discarded"
}
if(Resharing_YN==0){
Fr_Data.Frame$Location[Fr_Data.Frame$Location=="Shared"]<-"Discarded"
}
Pss_Data.Frame$Location[Pss_Data.Frame$Location=="Not Shared"]<-"Discarded"
Pss_Data.Frame$Location[Pss_Data.Frame$Location=="Not Consumed"]<-"Discarded"
if(Reservice_YN==0){
Pss_Data.Frame$Location[Pss_Data.Frame$Location=="Selection Table"]<-"Discarded"
}
if(Resharing_YN==0){
Pss_Data.Frame$Location[Pss_Data.Frame$Location=="Shared"]<-"Discarded"
}
Pre_Data.Frame$Location[Pre_Data.Frame$Location=="Not Shared"]<-"Discarded"
Pre_Data.Frame$Location[Pre_Data.Frame$Location=="Not Consumed"]<-"Discarded"
if(Reservice_YN==0){
Pre_Data.Frame$Location[Pre_Data.Frame$Location=="Selection Table"]<-"Discarded"
}
if(Resharing_YN==0){
Pre_Data.Frame$Location[Pre_Data.Frame$Location=="Shared"]<-"Discarded"
}
#Adding Services
Fr_Data.Frame<-func_Add_Services(Fr_Data.Frame)
Pss_Data.Frame<-func_Add_Services(Pss_Data.Frame)
Pre_Data.Frame<-func_Add_Services(Pre_Data.Frame)
#Adding the data to the datalist
datalistFr[[j]]<-Fr_Data.Frame
datalistPss[[j]]<-Pss_Data.Frame
datalistPre[[j]]<-Pre_Data.Frame
source("Output_Services.R")
List_Sens_Fr[[paste(l,k,j)]]<-Fr_Data.Frame
List_Sens_Pss[[paste(l,k,j)]]<-Pss_Data.Frame
List_Sens_Pre[[paste(l,k,j)]]<-Pre_Data.Frame
message("Service #", j)
} #end of second loop
#Creation of the Services Data Frames
Fr_Data = do.call(rbind,datalistFr)
Pss_Data = do.call(rbind,datalistPss)
Pre_Data = do.call(rbind,datalistPre)
#Adding Data into the Datalists
datalistFr_days[[k]]<-Fr_Data
datalistPss_days[[k]]<-Pss_Data
datalistPre_days[[k]]<-Pre_Data
source("Output_Days.R")
message("Day #", k)
}#end of day loop k
#source("Summary_WeekSens.R")
message("Done Gathering Data", l)
end_time<-Sys.time()
Total_time<-end_time-start_time
print(Total_time)
}
replicate(1,Main_z())
random_func<-function(){
x<-3+2
y<-4+3
}
random_func<-function(){
x<-3+2
y<-4+3
list<-list(x,y)
return(list())
}
sssssss<-random_func()
random_func<-function(){
x<-3+2
y<-4+3
listq<-list(x,y)
return(list())
}
random_func<-function(){
x<-3+2
y<-4+3
listq<-list(x,y)
return(listq)
}
sssssss<-random_func()
same<-random_func()
View(same)
x<-same[[1]]
y<-same[[2]]
random_func<-function(){
x<-3+2
y<-4+3
listq<-list(Ex=x,Wai=y)
return(listq)
}
same<-random_func()
View(same)
x<-same$Ex
y<-same$Wai
Func_Cross_Contamination<-function(Cont_Student,Data.Frame, Item_Picked, Item){
Conta<-Func_Index_DF(Data.Frame,Item_Picked,"Contamination")
if(salmonella==1){
#update the Fr Contamination in Data frame
Tr_H_F<-Cont_Student*TE_H_F #Transfer from Hand to Fruit
Tr_F_H<-(Conta* TE_F_H) #Tranfer from fruit to hand
}else if (norovirus ==1 && Wrapping_Apples==0 && Item == "Fruit"){
Conta<-round(Conta,digits = 0)
Cont_Student<-round(Cont_Student,digits = 0)
Tr_H_F<-rbinom(n=1,size = Cont_Student, prob = TrP_H_F)
Tr_F_H<-rbinom(n=1,size = Conta,prob = TrP_F_H)
}else if (norovirus ==1 && Wrapping_Apples==0 && (Item=="PSS" || Item=="PRE")){
Conta<-round(Conta,digits = 0)
Cont_Student<-round(Cont_Student,digits = 0)
Tr_H_F<-rbinom(n=1,size = Cont_Student, prob = TrP_H_S)
Tr_F_H<-rbinom(n=1,size = Conta,prob = TrP_S_H)
}else if (norovirus ==1 && Wrapping_Apples==1){
Conta<-round(Conta,digits = 0)
Cont_Student<-round(Cont_Student,digits = 0)
Tr_H_F<-rbinom(n=1,size = Cont_Student, prob = TrP_H_S)
Tr_F_H<-rbinom(n=1,size = Conta,prob = TrP_S_H)
}
#Contamination Tranfered History.
Overall_Tr<-(Tr_H_F-Tr_F_H)
Data.Frame[Item_Picked,colnames(Data.Frame)== "TouchesContHist"]<-paste(Data.Frame[Item_Picked,colnames(Data.Frame)=="TouchesContHist"], as.numeric(Overall_Tr),sep = ",") #Adding Contamination to
#Continuing Contamination
Cont_Updated<- Conta + Overall_Tr #New Contamination of Fruit
Cont_Difference<-Conta-(Cont_Updated) #Difference in contamination to update student contamination
Data.Frame[Item_Picked,colnames(Data.Frame)== "Contamination"]<-Cont_Updated #update the Fr Contamination in Data frame
Cont_Student<-ifelse(Cont_Student +(Cont_Difference)<0,0,Cont_Student +(Cont_Difference)) #Updating Contamination in Student's hands
#Adding Variables to Global Environment
OutputsFCC<-list(Data.Frame=Data.Frame, Cont_Student=Cont_Student)
return(OutputsFCC)
}
#Function for Picked Items
Func_Picked<-function(DF, Item_Picked, Item){
Search.df.fr<-Func_seach_Data4(DF,DF$Location,"Selection Table",Row_size_Fr)
#Fruit Selected #
Item_Picked<-as.numeric(Search.df.fr$Item.No.)
DF[Item_Picked,colnames(DF)== "Location"]<-"Tray"
DF[Item_Picked,colnames(DF)=="History"]<-paste(DF[Item_Picked,colnames(DF)=="History"], "Tray")
DF[Item_Picked,colnames(DF)=="History"]<-paste(DF[Item_Picked,colnames(DF)=="History"], "Touched")
DF<-DF
Item_Picked<-Item_Picked
OutputFP<-list(DF=DF, Item_Picked=Item_Picked)
}
Func_Touched<-function(DF,Item,RowSizeVar,Item_Picked){
#DF= Data Frame
#RowSizeVar= Variable Row Size from inputs
#Item = "Fruit" , "PSS" or "PRE"
#Item_Picked: Fr_Tocuhed or Pre_Toched, Pss_Touched
Search.df.item_touched<-Func_seach_Data4(DF,DF$Location,"Selection Table",RowSizeVar) #Searching for fruit to touch
Item_Picked<-as.numeric(Search.df.item_touched$Item.No.) #ITem touched
DF[Item_Picked,colnames(DF)=="History"]<-paste(DF[Item_Picked,colnames(DF)=="History"], "Touched") #Adding History to History
#Cross Contamination from Touching Fruit @Touch
OutputsCCF<-Func_Cross_Contamination(Cont_Student=Cont_Student,Data.Frame=DF, Item_Picked= Item_Picked, Item=Item)
Cont_Student<-OutputsCCF$Cont_Student
DF<-OutputsCCF$Data.Frame
#Cross Contamination from Allergens
DF<-Func_Allergen_CC(DF,Item_Picked) #Adding Allergen Contamination from touch.
OutputsFT<-list(DF=DF, Cont_Student=Cont_Student)
return(OutputsFT)
}
Func_Cross_Contamination<-function(Cont_Student,Data.Frame, Item_Picked, Item){
Conta<-Func_Index_DF(Data.Frame,Item_Picked,"Contamination")
if(salmonella==1){
#update the Fr Contamination in Data frame
Tr_H_F<-Cont_Student*TE_H_F #Transfer from Hand to Fruit
Tr_F_H<-(Conta* TE_F_H) #Tranfer from fruit to hand
}else if (norovirus ==1 && Wrapping_Apples==0 && Item == "Fruit"){
Conta<-round(Conta,digits = 0)
Cont_Student<-round(Cont_Student,digits = 0)
Tr_H_F<-rbinom(n=1,size = Cont_Student, prob = TrP_H_F)
Tr_F_H<-rbinom(n=1,size = Conta,prob = TrP_F_H)
}else if (norovirus ==1 && Wrapping_Apples==0 && (Item=="PSS" || Item=="PRE")){
Conta<-round(Conta,digits = 0)
Cont_Student<-round(Cont_Student,digits = 0)
Tr_H_F<-rbinom(n=1,size = Cont_Student, prob = TrP_H_S)
Tr_F_H<-rbinom(n=1,size = Conta,prob = TrP_S_H)
}else if (norovirus ==1 && Wrapping_Apples==1){
Conta<-round(Conta,digits = 0)
Cont_Student<-round(Cont_Student,digits = 0)
Tr_H_F<-rbinom(n=1,size = Cont_Student, prob = TrP_H_S)
Tr_F_H<-rbinom(n=1,size = Conta,prob = TrP_S_H)
}
#Contamination Tranfered History.
Overall_Tr<-(Tr_H_F-Tr_F_H)
Data.Frame[Item_Picked,colnames(Data.Frame)== "TouchesContHist"]<-paste(Data.Frame[Item_Picked,colnames(Data.Frame)=="TouchesContHist"], as.numeric(Overall_Tr),sep = ",") #Adding Contamination to
#Continuing Contamination
Cont_Updated<- Conta + Overall_Tr #New Contamination of Fruit
Cont_Difference<-Conta-(Cont_Updated) #Difference in contamination to update student contamination
Data.Frame[Item_Picked,colnames(Data.Frame)== "Contamination"]<-Cont_Updated #update the Fr Contamination in Data frame
Cont_Student<-ifelse(Cont_Student +(Cont_Difference)<0,0,Cont_Student +(Cont_Difference)) #Updating Contamination in Student's hands
#Adding Variables to Global Environment
OutputsFCC<-list(Data.Frame=Data.Frame, Cont_Student=Cont_Student)
return(OutputsFCC)
}
OutputsFT<-Func_Touched(DF = Fr_Data.Frame, RowSizeVar = Row_size_Fr, Item = "Fruit", Item_Picked = Fr_Touched)
#Creation of Data Frame for new Service.
source("Util_DataFrames.R")
Fr_Data.Frame<-data.frame("Item No." = 1:Initial_Fr,
"Location"= "Selection Table",
"Contamination" = as.numeric("0"),
"ContConsumed"=as.numeric("0"),
"Infection"=as.logical(""),
"Illness"= as.logical(""),
"InContamination"  = as.numeric("0"),
"ExposedAllergen" = FALSE,
"TotTime"= as.numeric("0"),
"History" = "",
"ConsumedBy"="",
"TouchesContHist"= as.numeric(""),
"WashHistory"= as.numeric("0"),
"TotServices"=as.numeric("0"),
"STtimes"= as.numeric("0"),
"Initial Day" = "1",
"Initial Service" = "1",
stringsAsFactors = FALSE
)
OutputsFT<-Func_Touched(DF = Fr_Data.Frame, RowSizeVar = Row_size_Fr, Item = "Fruit", Item_Picked = Fr_Touched)
Fr_Data.Frame<-data.frame("Item No." = 1:Initial_Fr,
"Location"= "Selection Table",
"Contamination" = as.numeric("0"),
"ContConsumed"=as.numeric("0"),
"Infection"=as.logical(""),
"Illness"= as.logical(""),
"InContamination"  = as.numeric("0"),
"ExposedAllergen" = FALSE,
"TotTime"= as.numeric("0"),
"History" = "",
"ConsumedBy"="",
"TouchesContHist"= as.numeric(""),
"WashHistory"= as.numeric("0"),
"TotServices"=as.numeric("0"),
"STtimes"= as.numeric("0"),
"Initial Day" = "1",
"Initial Service" = "1",
stringsAsFactors = FALSE
)
View(Fr_Data.Frame)
OutputsFT<-Func_Touched(DF = Fr_Data.Frame, RowSizeVar = Row_size_Fr, Item = "Fruit", Item_Picked = Fr_Touched)
source("Input_Static.R")
#Opening Libary and Inputs
source("Util_Library.R")
source("Input_Static.R")
source("Input_Functions.R")
source("Util_DFFunctions.R")
source("Util_DFWeekCreation.R")
source("Util_Counter&Lists.R")
#Functions
source("Util_Functions.R")
source("Util_CCFunctions2.R")
source("Util_VisualFunctions.R")
OutputsFT<-Func_Touched(DF = Fr_Data.Frame, RowSizeVar = Row_size_Fr, Item = "Fruit", Item_Picked = Fr_Touched)
Func_Touched<-function(DF,Item,RowSizeVar,Item_Picked){
#DF= Data Frame
#RowSizeVar= Variable Row Size from inputs
#Item = "Fruit" , "PSS" or "PRE"
#Item_Picked: Fr_Tocuhed or Pre_Toched, Pss_Touched
Search.df.item_touched<-Func_seach_Data4(DF,DF$Location,"Selection Table",RowSizeVar) #Searching for fruit to touch
Item_Picked<-as.numeric(Search.df.item_touched$Item.No.) #ITem touched
DF[Item_Picked,colnames(DF)=="History"]<-paste(DF[Item_Picked,colnames(DF)=="History"], "Touched") #Adding History to History
#Cross Contamination from Touching Fruit @Touch
OutputsCCF<-Func_Cross_Contamination(Cont_Student=Cont_Student,Data.Frame=DF, Item_Picked= Item_Picked, Item=Item)
Cont_Student<-OutputsCCF$Cont_Student
DF<-OutputsCCF$Data.Frame
#Cross Contamination from Allergens
DF<-Func_Allergen_CC(DF,Item_Picked) #Adding Allergen Contamination from touch.
OutputsFT<-list(DF=DF, Cont_Student=Cont_Student)
return(OutputsFT)
}
#Cross Contamination from Touching Fruit @Touch
OutputsCCF<-Func_Cross_Contamination(Cont_Student=Cont_Student,Data.Frame=DF, Item_Picked= Item_Picked, Item=Item)
OutputsFT<-Func_Touched(DF = Fr_Data.Frame, RowSizeVar = Row_size_Fr, Item = "Fruit", Item_Picked = Fr_Touched)
Search.df.item_touched<-Func_seach_Data4(DF,DF$Location,"Selection Table",RowSizeVar) #Searching for fruit to touch
Item<-"Fruit"
Item_Picked<-Fr_Touched
Search.Fr_Data.Frame.item_touched<-Func_seach_Data4(Fr_Data.Frame,Fr_Data.Frame$Location,"Selection Table",RowSizeVar) #Searching for fruit to touch
Search.Fr_Data.Frame.item_touched<-Func_seach_Data4(Fr_Data.Frame,Fr_Data.Frame$Location,"Selection Table",RowSizeVar) #Searching for fruit to touch
RowSizeVar<-20
Search.Fr_Data.Frame.item_touched<-Func_seach_Data4(Fr_Data.Frame,Fr_Data.Frame$Location,"Selection Table",RowSizeVar) #Searching for fruit to touch
RowSizeVar<-20
Search.Fr_Data.Frame.item_touched<-Func_seach_Data4(Fr_Data.Frame,Fr_Data.Frame$Location,"Selection Table",RowSizeVar) #Searching for fruit to touch
Item_Picked<-as.numeric(Search.Fr_Data.Frame.item_touched$Item.No.) #ITem touched
Fr_Data.Frame[Item_Picked,colnames(Fr_Data.Frame)=="History"]<-paste(Fr_Data.Frame[Item_Picked,colnames(Fr_Data.Frame)=="History"], "Touched") #Adding History to History
#Cross Contamination from Touching Fruit @Touch
OutputsCCF<-Func_Cross_Contamination(Cont_Student=Cont_Student,Data.Frame=Fr_Data.Frame, Item_Picked= Item_Picked, Item=Item)
Cont_Student<-200
Search.Fr_Data.Frame.item_touched<-Func_seach_Data4(Fr_Data.Frame,Fr_Data.Frame$Location,"Selection Table",RowSizeVar) #Searching for fruit to touch
Item_Picked<-as.numeric(Search.Fr_Data.Frame.item_touched$Item.No.) #ITem touched
Fr_Data.Frame[Item_Picked,colnames(Fr_Data.Frame)=="History"]<-paste(Fr_Data.Frame[Item_Picked,colnames(Fr_Data.Frame)=="History"], "Touched") #Adding History to History
#Cross Contamination from Touching Fruit @Touch
OutputsCCF<-Func_Cross_Contamination(Cont_Student=Cont_Student,Data.Frame=Fr_Data.Frame, Item_Picked= Item_Picked, Item=Item)
#Random Inputs for every kid.
source("Input_Random.R")  #We good!
#Calculations for initial contamination of the student.
source("Calc_StudentContamination.R")
#Feeding Items into the system is any items ran out.
source("Calc_FeedingItems.R")
#Cross Contamination from Touching Fruit @Touch
OutputsCCF<-Func_Cross_Contamination(Cont_Student=Cont_Student,Data.Frame=Fr_Data.Frame, Item_Picked= Item_Picked, Item=Item)
#Cross Contamination from Touching Fruit @Touch
OutputsCCF<-Func_Cross_Contamination(Cont_Student=Cont_Student,Data.Frame=Fr_Data.Frame, Item_Picked= Item_Picked, Item=Item)
Cont_Student<-OutputsCCF$Cont_Student
Fr_Data.Frame<-OutputsCCF$Data.Frame
Cont_Student
Cont_Student<-200
Search.Fr_Data.Frame.item_touched<-Func_seach_Data4(Fr_Data.Frame,Fr_Data.Frame$Location,"Selection Table",RowSizeVar) #Searching for fruit to touch
Item_Picked<-as.numeric(Search.Fr_Data.Frame.item_touched$Item.No.) #ITem touched
Fr_Data.Frame[Item_Picked,colnames(Fr_Data.Frame)=="History"]<-paste(Fr_Data.Frame[Item_Picked,colnames(Fr_Data.Frame)=="History"], "Touched") #Adding History to History
#Cross Contamination from Touching Fruit @Touch
OutputsCCF<-Func_Cross_Contamination(Cont_Student=Cont_Student,Data.Frame=Fr_Data.Frame, Item_Picked= Item_Picked, Item=Item)
Cont_Student<-OutputsCCF$Cont_Student
Cont_Student
Fr_Data.Frame<-OutputsCCF$Data.Frame
#Cross Contamination from Allergens
Fr_Data.Frame<-Func_Allergen_CC(Fr_Data.Frame,Item_Picked) #Adding Allergen Contamination from touch.
OutputsFT<-list(Fr_Data.Frame=Fr_Data.Frame, Cont_Student=Cont_Student)
return(OutputsFT)
OutputsFT<-Func_Touched(DF = Fr_Data.Frame, RowSizeVar = Row_size_Fr, Item = "Fruit", Item_Picked = Fr_Touched)
Fr_Data.Frame<-OutputsFT$DF
View(Fr_Data.Frame)
OutputFP<-Func_Picked(DF = Fr_Data.Frame,Item_Picked = Fr_Picked, Item = "Fruit")
#Function for Picked Items
Func_Picked<-function(DF, Item_Picked, Item){
Search.df.fr<-Func_seach_Data4(DF,DF$Location,"Selection Table",Row_size_Fr)
#Fruit Selected #
Item_Picked<-as.numeric(Search.df.fr$Item.No.)
DF[Item_Picked,colnames(DF)== "Location"]<-"Tray"
DF[Item_Picked,colnames(DF)=="History"]<-paste(DF[Item_Picked,colnames(DF)=="History"], "Tray")
DF[Item_Picked,colnames(DF)=="History"]<-paste(DF[Item_Picked,colnames(DF)=="History"], "Touched")
DF<-DF
Item_Picked<-Item_Picked
OutputFP<-list(DF=DF, Item_Picked=Item_Picked)
}
OutputFP<-Func_Picked(DF = Fr_Data.Frame,Item_Picked = Fr_Picked, Item = "Fruit")
View(OutputFP)
