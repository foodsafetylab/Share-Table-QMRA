Touch_YN_Fr<-ifelse(runif(1)<Pr_touch_Food,1,0)
#If touched what is the contamination and adding it to data frame?
if(Touch_YN_Fr==1){
ntouched_Fr<-round(rnorm(1,3,.5)*Touch_YN_Fr,0)
for (i in 1:ntouched_Fr){
Search.df.fr_touched<-Func_Search_Data(Fr_Data.Frame,Fr_Data.Frame$Location,"Selection Table",1)
Fr_Touched<-as.numeric(Search.df.fr_touched$Apple.No.)
Fr_Data.Frame[as.numeric(row.names(Search.df.fr_touched)),colnames(Fr_Data.Frame)== "Contamination"]<-
Func_Index_DF(Fr_Data.Frame,Fr_Touched,"Contamination") + Tr_H_Fr - (Func_Index_DF(Fr_Data.Frame,Fr_Touched,"Contamination")* TE_F_H)
Cont_Student<-ifelse(Cont_Student -  Func_Index_DF(Fr_Data.Frame,Fr_Touched,"Contamination")<0,0,Cont_Student -  Func_Index_DF(Fr_Data.Frame,Fr_Touched,"Contamination"))
}
}
#Student Picking Fruit from line#
Pick_YN_Fr<-ifelse(runif(1)<Pr_select_Fr,1,0)
V_Pick_YN_Fr<-c(V_Pick_YN_Fr,Pick_YN_Fr) ##VECTOR2##
#Picking a Fruit from Fruit Frame
if(Pick_YN_Fr==1){
Search.df.fr<-Func_Search_Data(Fr_Data.Frame,Fr_Data.Frame$Location,"Selection Table",1)
#Fruit Selected #
Fr_Picked<-as.numeric(Search.df.fr$Apple.No.)
Fr_Data.Frame[as.numeric(row.names(Search.df.fr)),colnames(Fr_Data.Frame)== "Location"]<-"Tray"
}
#Contamination from Hand to fruit Going into Tray
if(Pick_YN_Fr==1){
#Contamination at tray
Cont_Tray_Fr<- Func_Index_DF(Fr_Data.Frame,Fr_Picked,"Contamination") + Tr_H_Fr - (Func_Index_DF(Fr_Data.Frame,Fr_Picked,"Contamination")* TE_F_H)
#Add contamination to chosen fruit in Dataframe
Fr_Data.Frame[Fr_Picked,colnames(Fr_Data.Frame)== "Contamination"]<-Cont_Tray_Fr
}
#PSS
#Did student touch other Pss based on probability
Touch_YN_Pss<-ifelse(runif(1)<Pr_touch_Food,1,0)
#If touched what is the contamination and adding it to data frame
if(Touch_YN_Pss==1){
ntouched_Pss<-round(rnorm(1,3,.5)*Touch_YN_Pss,0)
for (i in 1:ntouched_Pss){
Search.df.Pss_touched<-Func_Search_Data(Pss_Data.Frame,Pss_Data.Frame$Location,"Selection Table",1)
Pss_Touched<-as.numeric(Search.df.Pss_touched$Pss.No.)
Pss_Data.Frame[as.numeric(row.names(Search.df.Pss_touched)),colnames(Pss_Data.Frame)== "Contamination"]<-
Func_Index_DF(Pss_Data.Frame, Pss_Touched,"Contamination") + Tr_H_Pss - (Func_Index_DF(Pss_Data.Frame,Pss_Touched,"Contamination")* TE_F_H)
Cont_Student<-ifelse(Cont_Student -  Func_Index_DF(Pss_Data.Frame,Pss_Touched,"Contamination")<0,0,Cont_Student -  Func_Index_DF(Pss_Data.Frame,Pss_Touched,"Contamination"))
}
}
#Student picking Pss from line
Pick_YN_Pss<-ifelse(runif(1)<Pr_select_Pss,1,0)
V_Pick_YN_Pss<-c(V_Pick_YN_Pss,Pick_YN_Pss)##VECTOR3##
#Picking a Pss from Pss Data Frame
if(Pick_YN_Pss==1){
Search.df.Pss<-Func_Search_Data(Pss_Data.Frame,Pss_Data.Frame$Location,"Selection Table",1)
#Pss Selected #
Pss_Picked<-as.numeric(Search.df.Pss$Pss.No.)
Pss_Data.Frame[as.numeric(row.names(Search.df.Pss)),colnames(Pss_Data.Frame)== "Location"]<-"Tray"
}
#Contamination From Hands to Pss going to Tray
if(Pick_YN_Pss==1){
#Contamination at tray
Cont_Tray_Pss<- Func_Index_DF(Pss_Data.Frame,Pss_Picked,"Contamination") + Tr_H_Pss - (Func_Index_DF(Pss_Data.Frame,Pss_Picked,"Contamination")* TE_F_H)
#Add contamination to chosen fruit in Dataframe
Pss_Data.Frame[Pss_Picked,colnames(Pss_Data.Frame)== "Contamination"]<-Cont_Tray_Pss
}
#PRE
#Did the Student touch any Pre during selection?
Touch_YN_Pre<-ifelse(runif(1)<Pr_touch_Food,1,0)
#If touched what is the contamination and adding it to data frame
if(Touch_YN_Pre==1){
ntouched_Pre<-round(rnorm(1,3,.5)*Touch_YN_Pre,0)
for (i in 1:ntouched_Pre){
Search.df.Pre_touched<-Func_Search_Data(Pre_Data.Frame,Pre_Data.Frame$Location,"Selection Table",1)
Pre_Touched<-as.numeric(Search.df.Pre_touched$Pre.No.)
Pre_Data.Frame[as.numeric(row.names(Search.df.Pre_touched)),colnames(Pre_Data.Frame)== "Contamination"]<-
Func_Index_DF(Pre_Data.Frame, Pre_Touched,"Contamination") + Tr_H_Pre - (Func_Index_DF(Pre_Data.Frame,Pre_Touched,"Contamination")* TE_F_H)
Cont_Student<-ifelse(Cont_Student -  Func_Index_DF(Pre_Data.Frame,Pre_Touched,"Contamination")<0,0,Cont_Student -  Func_Index_DF(Pre_Data.Frame,Pre_Touched,"Contamination"))
}
}
#Picking Pre from line
Pick_YN_Pre<-ifelse(runif(1)<Pr_select_Pre,1,0)
V_Pick_YN_Pre<-c(V_Pick_YN_Pre,Pick_YN_Pre)##VECTOR4##
#Picking a Pre from Pre Data Frame
if(Pick_YN_Pre==1){
Search.df.Pre<-Func_Search_Data(Pre_Data.Frame,Pre_Data.Frame$Location,"Selection Table",1)
#Pre Selected #
Pre_Picked<-as.numeric(Search.df.Pre$Pre.No.)
Pre_Data.Frame[as.numeric(row.names(Search.df.Pre)),colnames(Pre_Data.Frame)== "Location"]<-"Tray"
}
#Contamination From Hands to Pss going to Tray
if(Pick_YN_Pre==1){
#Contamination at tray
Cont_Tray_Pre<- Func_Index_DF(Pre_Data.Frame,Pre_Picked,"Contamination") + Tr_H_Pre - (Func_Index_DF(Pre_Data.Frame,Pre_Picked,"Contamination")* TE_F_H)
#Add contamination to chosen fruit in Dataframe
Pre_Data.Frame[Pre_Picked,colnames(Pre_Data.Frame)== "Contamination"]<-Cont_Tray_Pre
}
#Counter of fruit selected in "Tray"====================================================
Counter_Fruit<-sum(Fr_Data.Frame$Location=="Tray")
Counter_Pss<-sum(Pss_Data.Frame$Location=="Tray")
Counter_Pre<-sum(Pre_Data.Frame$Location=="Tray")
##Available Fruit#=====================================================================
Available_Fr<-sum(Fr_Data.Frame$Location=="Selection Table")
V_Available_Fr<-c(V_Available_Fr,Available_Fr)##VECTOR 8##
Available_Pss<-sum(Pss_Data.Frame$Location=="Selection Table")
V_Available_Pss<-c(V_Available_Pss,Available_Pss)##VECTOR 9##
Available_Pre<-sum(Pre_Data.Frame$Location=="Selection Table")
V_Available_Pre<-c(V_Available_Pre,Available_Pre)##VECTOR 10##
# Consumption==========================================================================
#Fruit
#Did the student consume the Fruit?
Eat_YN_Fr<-ifelse(runif(1)<Pr_eat_Fr,1,0)
#Changing Data Frame so it updates when student consumesfruit.
if(Eat_YN_Fr==1){
Fr_Data.Frame[Fr_Picked,colnames(Fr_Data.Frame)== "Location"]<-"Consumed"
}else{
Fr_Data.Frame[Fr_Picked,colnames(Fr_Data.Frame)== "Location"]<-"Not Consumed"
}
#Pss
#Did student consume the Pss
Eat_YN_Pss<-ifelse(runif(1)<Pr_eat_Pss,1,0)
#Changing Data Frame for consumption of Pss
if(Eat_YN_Pss==1){
Pss_Data.Frame[Pss_Picked,colnames(Pss_Data.Frame)== "Location"]<-"Consumed"
}else{
Pss_Data.Frame[Pss_Picked,colnames(Pss_Data.Frame)== "Location"]<-"Not Consumed"
}
#Pre
#Did student consume the Pre
Eat_YN_Pre<-ifelse(runif(1)<Pr_eat_Pre,1,0)
#Changind Data Frame for consumption of Pre
if(Eat_YN_Pre==1){
Pre_Data.Frame[Pre_Picked,colnames(Pre_Data.Frame)== "Location"]<-"Consumed"
}else{
Pre_Data.Frame[Pre_Picked,colnames(Pre_Data.Frame)== "Location"]<-"Not Consumed"
}
#Consumption to share table=======================================================
#Proability of the student sharing their food.
Share_YN_Food<-ifelse(runif(1)<Pr_share_Food,1,0)
#Fruit
#Items in Share Table:
if(Fr_Data.Frame[Fr_Picked,colnames(Fr_Data.Frame)=="Location"]== "Not Consumed"){
if(Share_YN_Food==1){
Fr_Data.Frame[Fr_Picked,colnames(Fr_Data.Frame)== "Location"]<-"Shared"
}else{
Fr_Data.Frame[Fr_Picked,colnames(Fr_Data.Frame)== "Location"]<-"Not Shared"
}
}
#Pss
if(Pss_Data.Frame[Pss_Picked,colnames(Pss_Data.Frame)=="Location"]== "Not Consumed"){
if(Share_YN_Food==1){
Pss_Data.Frame[Pss_Picked,colnames(Pss_Data.Frame)== "Location"]<-"Shared"
}else{
Pss_Data.Frame[Pss_Picked,colnames(Pss_Data.Frame)== "Location"]<-"Not Shared"
}
}
#Pre
if(Pre_Data.Frame[Pre_Picked,colnames(Pre_Data.Frame)=="Location"]== "Not Consumed"){
if(Share_YN_Food==1){
Pre_Data.Frame[Pre_Picked,colnames(Pre_Data.Frame)== "Location"]<-"Shared"
}else{
Pre_Data.Frame[Fr_Picked,colnames(Pre_Data.Frame)== "Location"]<-"Not Shared"
}
}
}
####RUN FROM HERE####
# INPUTS ------------------------------------------------------------------
#Initial Number of fruit
Initial_Fr<-200 #Number of fruit
Initial_Pss<-200 #number of Packaged shelf stable
Initial_Pre<-200 #number of packaged refrigirated
#Initial Contamination of food items (norovirus particles)
IC_Fruit<-0 #particles
IC_Pss<-0 #particles
IC_Pre<-0 #particles
#Transfers Efficiencies - If Random we will move this to the loop-
TE_H_F<-.209 #TE between hands and food
TE_H_S<-.1340 #TE between Hands and Surfaces
TE_F_H<-.1020 #TE between Food and Hands
TE_F_S<-.0250 #TE between Food and Surfaces
TE_S_H<-.1090 #TE between Surfaces and Hands
TE_S_F<-.4620 #TE between Surfaces and Foods
#Probability of student Picking up food from line-
#Probability of Selecting Fruit
Pr_select_Fr<-0.9
#Probability of Selecting Pss
Pr_select_Pss<-0.9
#Probability of selecting Pre
Pr_select_Pre<-0.9
#Porbability of Student touching other line items before picking their food.
Pr_touch_Food<-0.3
#Proabbility of consuming Food
Pr_eat_Fr<-.8
Pr_eat_Pss<-.8
Pr_eat_Pre<-.8
#Probability of sharing food.
Pr_share_Food<-.9
# FOOD POOL DATAFRAMES ----------------------------------------------------
#Fruit Data Frame
Fr_Data.Frame<-data.frame("Apple No." = 1:Initial_Fr,
"Location"= "Selection Table",
"Contamination" = "0",
"Times in ST" = "0",
"History" = "0",
stringsAsFactors = FALSE
)
#Packaged Shelf Stable Data Frame
Pss_Data.Frame<-data.frame("Pss No." = 1:Initial_Pss,
"Location"= "Selection Table",
"Contamination" = "0",
"Times in ST" = "0",
"History"= "0",stringsAsFactors = FALSE
)
#Packaged Shelf Stable Data Frame
Pre_Data.Frame<-data.frame("Pre No." = 1:Initial_Pss,
"Location"= "Selection Table",
"Contamination" = "0",
"Times in ST" = "0",
"History" = "0", stringsAsFactors = FALSE
)
# FUNCTIONS ---------------------------------------------------------------
#--Function for Contamination of Specific Item at Tray
# a = Contamination original b= Tra 1 c= Tra 2 d= Pick yes or no , e= Cont h after
Funct_Cont_Tray_Item<-function(a,b,c,d,e){
ifelse(((a+b)-(c))*d>e,
e,
((a+b)-(c))*d)
}
#--Function for contamination at service (used in Cont_Service_Fr	 Cont_Service_Pss	 Cont_Service_Pre)
# a=Number of touched fruit, b= TR 1 c= Tr 2, d= Contamination before e = Contamination in tray before
Func_Cont_Service<-function(a,b,c,d,e){
ifelse(a*(b - c)>((d)-(e)),
(d)-(e),
(a)*(b - c))
}
#--Function for searching data frame--
# a=Data Frame looking b= Colum in data frame c= Keywrd using "", d=number of selections
Func_Search_Data<-function(a,b,c,d){
a[ sample( which(b==c),d),]
}
#Items touched during selection:
#a = data frame, b=#touched c#"contamination" col name
Func_Index_DF<-function(a,b,c){
as.numeric(a[b,colnames(a)==c])
}
# INITIALIZING COUNTERS ---------------------------------------------------
#Total Contamination add the end of iteration #not infput
Total_Cont_fr<-0
Total_Cont_Pss<-0
Total_Cont_Pre<-0
#Initial Amounts of food selected #not input
Initial_Fr_Selected<-0
Initial_Pss_Selected<-0
Initial_Pre_Selected<-0
##Contamination Pool Start# Not input
Cont_Fr<- 0
Cont_Pss<-0
Cont_Pre<-0
##Number of share table items #NotInput
Shared_Fr<-0
Shared_Pss<-0
Shared_Pre<-0
# Initialize Vectors for Final Data Frame --------------------------------- #Maybe wont need based on changes#
V_Cont_Student<-c(0)
V_Pick_YN_Fr<-c(0)
V_Pick_YN_Pss<-c(0)
V_Pick_YN_Pre<-c(0)
V_ntouched_Fr<-c(0)
V_ntouched_Pss<-c(0)
V_ntouched_Pre<-c(0)
V_Available_Fr<-c(0)
V_Available_Pss<-c(0)
V_Available_Pre<-c(0)
V_Shared_Fr<-c(0)
V_Shared_Pss<-c(0)
V_Shared_Pre<-c(0)
# FUNCTION RUNS ITERATIONS ------------------------------------------------
for (i in 1:200){
#Probability of Initial Contamination Student================================================
Pr_Student_iC<-.1
#Contamination Level if Student is contaminated:
IC_Student<- rnorm(1,1000,200)
#Running Student Contamination based on Probability.
Cont_Student<- ifelse(runif(1)<Pr_Student_iC,IC_Student,0)
#VECTOR 1, contamination of student.
V_Cont_Student<-c(V_Cont_Student,Cont_Student)
#Total transfer of particles=================================================================
Tr_H_Fr<-Cont_Student*TE_H_F
Tr_Fr_H<-Cont_Fr*TE_F_H
Tr_H_Pss<- Cont_Student*TE_H_F
Tr_Pss_H<-Cont_Pss*TE_F_H
Tr_H_Pre<-Cont_Student*TE_H_F
Tr_Pre_H<-Cont_Pre*TE_F_H
#Student Selection ===========================================================================
#FRUIT
#Student Touching Fruit in line
#Did Student touch other fruit based on probability?
Touch_YN_Fr<-ifelse(runif(1)<Pr_touch_Food,1,0)
#If touched what is the contamination and adding it to data frame?
if(Touch_YN_Fr==1){
ntouched_Fr<-round(rnorm(1,3,.5)*Touch_YN_Fr,0)
for (i in 1:ntouched_Fr){
Search.df.fr_touched<-Func_Search_Data(Fr_Data.Frame,Fr_Data.Frame$Location,"Selection Table",1)
Fr_Touched<-as.numeric(Search.df.fr_touched$Apple.No.)
Fr_Data.Frame[as.numeric(row.names(Search.df.fr_touched)),colnames(Fr_Data.Frame)== "Contamination"]<-
Func_Index_DF(Fr_Data.Frame,Fr_Touched,"Contamination") + Tr_H_Fr - (Func_Index_DF(Fr_Data.Frame,Fr_Touched,"Contamination")* TE_F_H)
Cont_Student<-ifelse(Cont_Student -  Func_Index_DF(Fr_Data.Frame,Fr_Touched,"Contamination")<0,0,Cont_Student -  Func_Index_DF(Fr_Data.Frame,Fr_Touched,"Contamination"))
}
}
#Student Picking Fruit from line#
Pick_YN_Fr<-ifelse(runif(1)<Pr_select_Fr,1,0)
V_Pick_YN_Fr<-c(V_Pick_YN_Fr,Pick_YN_Fr) ##VECTOR2##
#Picking a Fruit from Fruit Frame
if(Pick_YN_Fr==1){
Search.df.fr<-Func_Search_Data(Fr_Data.Frame,Fr_Data.Frame$Location,"Selection Table",1)
#Fruit Selected #
Fr_Picked<-as.numeric(Search.df.fr$Apple.No.)
Fr_Data.Frame[as.numeric(row.names(Search.df.fr)),colnames(Fr_Data.Frame)== "Location"]<-"Tray"
}
#Contamination from Hand to fruit Going into Tray
if(Pick_YN_Fr==1){
#Contamination at tray
Cont_Tray_Fr<- Func_Index_DF(Fr_Data.Frame,Fr_Picked,"Contamination") + Tr_H_Fr - (Func_Index_DF(Fr_Data.Frame,Fr_Picked,"Contamination")* TE_F_H)
#Add contamination to chosen fruit in Dataframe
Fr_Data.Frame[Fr_Picked,colnames(Fr_Data.Frame)== "Contamination"]<-Cont_Tray_Fr
}
#PSS
#Did student touch other Pss based on probability
Touch_YN_Pss<-ifelse(runif(1)<Pr_touch_Food,1,0)
#If touched what is the contamination and adding it to data frame
if(Touch_YN_Pss==1){
ntouched_Pss<-round(rnorm(1,3,.5)*Touch_YN_Pss,0)
for (i in 1:ntouched_Pss){
Search.df.Pss_touched<-Func_Search_Data(Pss_Data.Frame,Pss_Data.Frame$Location,"Selection Table",1)
Pss_Touched<-as.numeric(Search.df.Pss_touched$Pss.No.)
Pss_Data.Frame[as.numeric(row.names(Search.df.Pss_touched)),colnames(Pss_Data.Frame)== "Contamination"]<-
Func_Index_DF(Pss_Data.Frame, Pss_Touched,"Contamination") + Tr_H_Pss - (Func_Index_DF(Pss_Data.Frame,Pss_Touched,"Contamination")* TE_F_H)
Cont_Student<-ifelse(Cont_Student -  Func_Index_DF(Pss_Data.Frame,Pss_Touched,"Contamination")<0,0,Cont_Student -  Func_Index_DF(Pss_Data.Frame,Pss_Touched,"Contamination"))
}
}
#Student picking Pss from line
Pick_YN_Pss<-ifelse(runif(1)<Pr_select_Pss,1,0)
V_Pick_YN_Pss<-c(V_Pick_YN_Pss,Pick_YN_Pss)##VECTOR3##
#Picking a Pss from Pss Data Frame
if(Pick_YN_Pss==1){
Search.df.Pss<-Func_Search_Data(Pss_Data.Frame,Pss_Data.Frame$Location,"Selection Table",1)
#Pss Selected #
Pss_Picked<-as.numeric(Search.df.Pss$Pss.No.)
Pss_Data.Frame[as.numeric(row.names(Search.df.Pss)),colnames(Pss_Data.Frame)== "Location"]<-"Tray"
}
#Contamination From Hands to Pss going to Tray
if(Pick_YN_Pss==1){
#Contamination at tray
Cont_Tray_Pss<- Func_Index_DF(Pss_Data.Frame,Pss_Picked,"Contamination") + Tr_H_Pss - (Func_Index_DF(Pss_Data.Frame,Pss_Picked,"Contamination")* TE_F_H)
#Add contamination to chosen fruit in Dataframe
Pss_Data.Frame[Pss_Picked,colnames(Pss_Data.Frame)== "Contamination"]<-Cont_Tray_Pss
}
#PRE
#Did the Student touch any Pre during selection?
Touch_YN_Pre<-ifelse(runif(1)<Pr_touch_Food,1,0)
#If touched what is the contamination and adding it to data frame
if(Touch_YN_Pre==1){
ntouched_Pre<-round(rnorm(1,3,.5)*Touch_YN_Pre,0)
for (i in 1:ntouched_Pre){
Search.df.Pre_touched<-Func_Search_Data(Pre_Data.Frame,Pre_Data.Frame$Location,"Selection Table",1)
Pre_Touched<-as.numeric(Search.df.Pre_touched$Pre.No.)
Pre_Data.Frame[as.numeric(row.names(Search.df.Pre_touched)),colnames(Pre_Data.Frame)== "Contamination"]<-
Func_Index_DF(Pre_Data.Frame, Pre_Touched,"Contamination") + Tr_H_Pre - (Func_Index_DF(Pre_Data.Frame,Pre_Touched,"Contamination")* TE_F_H)
Cont_Student<-ifelse(Cont_Student -  Func_Index_DF(Pre_Data.Frame,Pre_Touched,"Contamination")<0,0,Cont_Student -  Func_Index_DF(Pre_Data.Frame,Pre_Touched,"Contamination"))
}
}
#Picking Pre from line
Pick_YN_Pre<-ifelse(runif(1)<Pr_select_Pre,1,0)
V_Pick_YN_Pre<-c(V_Pick_YN_Pre,Pick_YN_Pre)##VECTOR4##
#Picking a Pre from Pre Data Frame
if(Pick_YN_Pre==1){
Search.df.Pre<-Func_Search_Data(Pre_Data.Frame,Pre_Data.Frame$Location,"Selection Table",1)
#Pre Selected #
Pre_Picked<-as.numeric(Search.df.Pre$Pre.No.)
Pre_Data.Frame[as.numeric(row.names(Search.df.Pre)),colnames(Pre_Data.Frame)== "Location"]<-"Tray"
}
#Contamination From Hands to Pss going to Tray
if(Pick_YN_Pre==1){
#Contamination at tray
Cont_Tray_Pre<- Func_Index_DF(Pre_Data.Frame,Pre_Picked,"Contamination") + Tr_H_Pre - (Func_Index_DF(Pre_Data.Frame,Pre_Picked,"Contamination")* TE_F_H)
#Add contamination to chosen fruit in Dataframe
Pre_Data.Frame[Pre_Picked,colnames(Pre_Data.Frame)== "Contamination"]<-Cont_Tray_Pre
}
#Counter of fruit selected in "Tray"====================================================
Counter_Fruit<-sum(Fr_Data.Frame$Location=="Tray")
Counter_Pss<-sum(Pss_Data.Frame$Location=="Tray")
Counter_Pre<-sum(Pre_Data.Frame$Location=="Tray")
##Available Fruit#=====================================================================
Available_Fr<-sum(Fr_Data.Frame$Location=="Selection Table")
V_Available_Fr<-c(V_Available_Fr,Available_Fr)##VECTOR 8##
Available_Pss<-sum(Pss_Data.Frame$Location=="Selection Table")
V_Available_Pss<-c(V_Available_Pss,Available_Pss)##VECTOR 9##
Available_Pre<-sum(Pre_Data.Frame$Location=="Selection Table")
V_Available_Pre<-c(V_Available_Pre,Available_Pre)##VECTOR 10##
# Consumption==========================================================================
#Fruit
#Did the student consume the Fruit?
Eat_YN_Fr<-ifelse(runif(1)<Pr_eat_Fr,1,0)
#Changing Data Frame so it updates when student consumesfruit.
if(Eat_YN_Fr==1){
Fr_Data.Frame[Fr_Picked,colnames(Fr_Data.Frame)== "Location"]<-"Consumed"
}else{
Fr_Data.Frame[Fr_Picked,colnames(Fr_Data.Frame)== "Location"]<-"Not Consumed"
}
#Pss
#Did student consume the Pss
Eat_YN_Pss<-ifelse(runif(1)<Pr_eat_Pss,1,0)
#Changing Data Frame for consumption of Pss
if(Eat_YN_Pss==1){
Pss_Data.Frame[Pss_Picked,colnames(Pss_Data.Frame)== "Location"]<-"Consumed"
}else{
Pss_Data.Frame[Pss_Picked,colnames(Pss_Data.Frame)== "Location"]<-"Not Consumed"
}
#Pre
#Did student consume the Pre
Eat_YN_Pre<-ifelse(runif(1)<Pr_eat_Pre,1,0)
#Changind Data Frame for consumption of Pre
if(Eat_YN_Pre==1){
Pre_Data.Frame[Pre_Picked,colnames(Pre_Data.Frame)== "Location"]<-"Consumed"
}else{
Pre_Data.Frame[Pre_Picked,colnames(Pre_Data.Frame)== "Location"]<-"Not Consumed"
}
#Consumption to share table=======================================================
#Proability of the student sharing their food.
Share_YN_Food<-ifelse(runif(1)<Pr_share_Food,1,0)
#Fruit
#Items in Share Table:
if(Fr_Data.Frame[Fr_Picked,colnames(Fr_Data.Frame)=="Location"]== "Not Consumed"){
if(Share_YN_Food==1){
Fr_Data.Frame[Fr_Picked,colnames(Fr_Data.Frame)== "Location"]<-"Shared"
}else{
Fr_Data.Frame[Fr_Picked,colnames(Fr_Data.Frame)== "Location"]<-"Not Shared"
}
}
#Pss
if(Pss_Data.Frame[Pss_Picked,colnames(Pss_Data.Frame)=="Location"]== "Not Consumed"){
if(Share_YN_Food==1){
Pss_Data.Frame[Pss_Picked,colnames(Pss_Data.Frame)== "Location"]<-"Shared"
}else{
Pss_Data.Frame[Pss_Picked,colnames(Pss_Data.Frame)== "Location"]<-"Not Shared"
}
}
#Pre
if(Pre_Data.Frame[Pre_Picked,colnames(Pre_Data.Frame)=="Location"]== "Not Consumed"){
if(Share_YN_Food==1){
Pre_Data.Frame[Pre_Picked,colnames(Pre_Data.Frame)== "Location"]<-"Shared"
}else{
Pre_Data.Frame[Fr_Picked,colnames(Pre_Data.Frame)== "Location"]<-"Not Shared"
}
}
}
View(Pre_Data.Frame)
View(Fr_Data.Frame)
Fr_Data.Frame<-data.frame("Apple No." = 1:Initial_Fr,
"Location"= "Selection Table",
"Contamination" = "0",
"Times in ST" = "0",
"History" = "0",
stringsAsFactors = FALSE
)
Initial_Fr<-30
Fr_Data.Frame<-data.frame("Apple No." = 1:Initial_Fr,
"Location"= "Selection Table",
"Contamination" = "0",
"Times in ST" = "0",
"History" = "0",
stringsAsFactors = FALSE
)
picked_a<-23
Fr_Data.Frame[picked_a,colnames(Fr_Data.Frame)== "Location"]<-Fr_Data.Frame[picked_a,colnames(Fr_Data.Frame)== "Location"]+"Tray"
Fr_Data.Frame[picked_a,colnames(Fr_Data.Frame)== "Location"]<-'Fr_Data.Frame[picked_a,colnames(Fr_Data.Frame)== "Location"]+"Tray""
Fr_Data.Frame[picked_a,colnames(Fr_Data.Frame)== "Location"]<-'"Tray"
picked_a<-23
Fr_Data.Frame[picked_a,colnames(Fr_Data.Frame)== "Location"]<-'"Tray"
Fr_Data.Frame[picked_a,colnames(Fr_Data.Frame)== "Location"]<-"Tray"
>
>
>
4
,
Initial_Fr<-30
Fr_Data.Frame<-data.frame("Apple No." = 1:Initial_Fr,
"Location"= "Selection Table",
"Contamination" = "0",
"Times in ST" = "0",
"History" = "0",
stringsAsFactors = FALSE
)
picked_a<-23
Fr_Data.Frame[picked_a,colnames(Fr_Data.Frame)== "Location"]<-"Tray"
>
<
Initial_Fr<-30
Fr_Data.Frame<-data.frame("Apple No." = 1:Initial_Fr,
"Location"= "Selection Table",
"Contamination" = "0",
"Times in ST" = "0",
"History" = "0",
stringsAsFactors = FALSE
)
picked_a<-23
Fr_Data.Frame[picked_a,colnames(Fr_Data.Frame)== "Location"]<-"Tray"
View(Fr_Data.Frame)
#Library
source("ST_Library.R")
#Library
source("ST_Library.R")
setwd("C:/Users/gareyes3/Documents/GitHub/Share-Table-QMRA/R")
#Library
source("ST_Library.R")
rbetagen(1000,0.76,1.04,0.0126,.46)
Trans<-rbetagen(1000,0.76,1.04,0.0126,.46)
mean(Trans)
