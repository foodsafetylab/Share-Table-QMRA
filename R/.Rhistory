source("Input_Functions.R")
source("Util_DFFunctions.R")
source("Util_DFWeekCreation.R")
source("Util_Counter&Lists.R")
#Functions
source("Util_Functions.R")
source("Util_CCFunctions2.R")
source("Util_VisualFunctions.R")
#Share Table Toggle
#Include Share Table:
Share_Table_YN<-0
#NOTE: Turn off Re-Sharing and -ST to reservice too (next section)
# Re-Sharing, Re-Service
#Share Table to Service line after every Day # note turn in 1 if ST on
STtoReservice_YN<-0
#Re-Sharing of Share table items after every service # note turn in 1 is ST on
Resharing_YN<-0
#Changing Inputs for Washing off, Wraaping on.
#Washing Between Services
Wash_Between_Services<-0
#Wash Selection Table Fruit
Wash_Selection_YN_Fr<-0
#Wash Share Table Items
Wash_ST_YN_Fr<-0
#Changing Wrapping off:
#Wrapping Apples
Wrapping_Apples<-1
#Running Loop again:-------------------------------------
source("Main_Loops2.R")
#Summary DFs for Future.-------------------------------------
#Creating Data Frame of Consumed Items for all the products
#Copy of Compiled Data Frame
Individual_Analysis_Fr_CopOFFWr<-bind_rows(List_Sens_Fr)
#Data Frame without repeats and Consumed Items
ST_OFFWr_Analysis<-Func_Asys_MainDF(SummaryList = List_Sens_Fr,FoodType = "Fruit")
#ST ON-------------------------------------
ST_ON_Analysis_Copy<-ST_ON_Analysis
ST_ON_Analysis<-Func_Asys_ContbyStudent(ST_ON_Analysis)
#Analysis For weekly Dose Response ON
OutputsDRON<-Func_DR_Main(AnalysisDF = ST_ON_Analysis, Reps_DR = 100)
df_inf_Week_ON<-OutputsDRON$df_inf_Week
df_ill_Week_ON<-OutputsDRON$df_ill_Week
#ST OFF-------------------------------------
ST_OFF_Analysis_Copy<-ST_OFF_Analysis
ST_OFF_Analysis<-Func_Asys_ContbyStudent(ST_OFF_Analysis)
#Analysis For weekly Dose Response ON
OutputsDROFF<-Func_DR_Main(AnalysisDF = ST_OFF_Analysis, Reps_DR = 100)
df_inf_Week_OFF<-OutputsDROFF$df_inf_Week
df_ill_Week_OFF<-OutputsDROFF$df_ill_Week
#ST ON Wash ONF-------------------------------------
ST_ONWash_Analysis_Copy<-ST_ONWash_Analysis
ST_ONWash_Analysis<-Func_Asys_ContbyStudent(ST_ONWash_Analysis)
#Analysis For weekly Dose Response ON
OutputsDRONWash<-Func_DR_Main(AnalysisDF = ST_ONWash_Analysis, Reps_DR = 100)
df_inf_Week_ONWash<-OutputsDRONWash$df_inf_Week
df_ill_Week_ONWash<-OutputsDRONWash$df_ill_Week
#ST ON Wrapp ON-------------------------------------
ST_ONWr_Analysis_Copy<-ST_ONWr_Analysis
ST_ONWr_Analysis<-Func_Asys_ContbyStudent(ST_ONWr_Analysis)
#Analysis For weekly Dose Response ON
OutputsDRONWr<-Func_DR_Main(AnalysisDF = ST_ONWr_Analysis, Reps_DR = 100)
#Inputs and Source Files-------------------------------------
start_time<-Sys.time()
#Inputs
source("Input_Static.R")
source("Input_Functions.R")
source("Util_DFFunctions.R")
source("Util_DFWeekCreation.R")
source("Util_Counter&Lists.R")
#Functions
source("Util_Functions.R")
source("Util_CCFunctions2.R")
source("Util_VisualFunctions.R")
#Changing Inputs for Washing off, Wraaping on.
#Washing Between Services
Wash_Between_Services<-0
#Wash Selection Table Fruit
Wash_Selection_YN_Fr<-0
#Wash Share Table Items
Wash_ST_YN_Fr<-0
#Changing Wrapping off:
#Wrapping Apples
Wrapping_Apples<-1
#Running Loop again:-------------------------------------
source("Main_Loops2.R")
#ST ON Wrapp ON-------------------------------------
ST_ONWr_Analysis_Copy<-ST_ONWr_Analysis
ST_ONWr_Analysis<-Func_Asys_ContbyStudent(ST_ONWr_Analysis)
#Analysis For weekly Dose Response ON
OutputsDRONWr<-Func_DR_Main(AnalysisDF = ST_ONWr_Analysis, Reps_DR = 100)
#Summary DFs for Future.
#Creating Data Frame of Consumed Items for all the products
#Copy of Compiled Data Frame
Individual_Analysis_Fr_CopONWr<-bind_rows(List_Sens_Fr)
#Data Frame without repeats and Consumed Items
ST_ONWr_Analysis<-Func_Asys_MainDF(SummaryList = List_Sens_Fr,FoodType = "Fruit")
#ST ON Wrapp ON-------------------------------------
ST_ONWr_Analysis_Copy<-ST_ONWr_Analysis
ST_ONWr_Analysis<-Func_Asys_ContbyStudent(ST_ONWr_Analysis)
#Analysis For weekly Dose Response ON
OutputsDRONWr<-Func_DR_Main(AnalysisDF = ST_ONWr_Analysis, Reps_DR = 100)
df_inf_Week_ONWr<-OutputsDRONWr$df_inf_Week
df_ill_Week_ONWr<-OutputsDRONWr$df_ill_Week
#ST ST OFF Wash ON-------------------------------------
ST_OFFWash_Analysis_Copy<-ST_OFFWash_Analysis
ST_OFFWash_Analysis<-Func_Asys_ContbyStudent(ST_OFFWash_Analysis)
#Analysis For weekly Dose Response ON
OutputsDROFFWash<-Func_DR_Main(AnalysisDF = ST_OFFWash_Analysis, Reps_DR = 100)
df_inf_Week_OFFWash<-OutputsDROFFWash$df_inf_Week
df_ill_Week_OFFWash<-OutputsDROFFWash$df_ill_Week
#ST OFF Wrapp ONF-------------------------------------
ST_OFFWr_Analysis_Copy<-ST_OFFWr_Analysis
ST_OFFWr_Analysis<-Func_Asys_ContbyStudent(ST_OFFWr_Analysis)
#Analysis For weekly Dose Response ON
OutputsDROFFWr<-Func_DR_Main(AnalysisDF = ST_OFFWr_Analysis, Reps_DR = 100)
df_inf_Week_OFFWr<-OutputsDROFFWr$df_inf_Week
df_ill_Week_OFFWr<-OutputsDROFFWr$df_ill_Week
#ST ON
df_ill_Week_ON_Box_Prev<-Func_DF_Prevalence(AnalysisDFCop = ST_ON_Analysis_Copy, df_Ill_Week = df_ill_Week_ON,Intervention = "STON")
#ST OFF
df_ill_Week_OFF_Box_Prev<-Func_DF_Prevalence(AnalysisDFCop = ST_OFF_Analysis_Copy, df_Ill_Week = df_ill_Week_OFF,Intervention = "STOFF")
#ST ONWash
df_ill_Week_ONWash_Box_Prev<-Func_DF_Prevalence(AnalysisDFCop = ST_ONWash_Analysis_Copy, df_Ill_Week = df_ill_Week_ONWash,Intervention = "ONwash")
#ST ONWr
df_ill_Week_ONWr_Box_Prev<-Func_DF_Prevalence(AnalysisDFCop = ST_ONWr_Analysis_Copy, df_Ill_Week = df_ill_Week_ONWr,Intervention = "ONWr")
#ST OFFWash
df_ill_Week_OFFWash_Box_Prev<-Func_DF_Prevalence(AnalysisDFCop = ST_OFFWash_Analysis_Copy, df_Ill_Week = df_ill_Week_OFFWash,Intervention = "OFFWash")
#ST OFFWr
df_ill_Week_OFFWr_Box_Prev<-Func_DF_Prevalence(AnalysisDFCop = ST_OFFWr_Analysis_Copy, df_Ill_Week = df_ill_Week_OFFWr,Intervention = "OFFWr")
View(df_ill_Week_OFF_Box_Prev)
df_inf_Week_Tog_Box<-bind_rows(df_inf_Week_ON_Box_Prev,df_inf_Week_OFF_Box_Prev,df_ill_Week_ONWash_Box_Prev,df_ill_Week_ONWr_Box_Prev,df_ill_Week_OFFWash_Box_Prev,df_ill_Week_OFFWr_Box_Prev)
#Boxplot Together
df_inf_Week_Tog_Box<-bind_rows(df_ill_Week_ON_Box_Prev,df_ill_Week_OFF_Box_Prev,df_ill_Week_ONWash_Box_Prev,df_ill_Week_ONWr_Box_Prev,df_ill_Week_OFFWash_Box_Prev,df_ill_Week_OFFWr_Box_Prev)
#Boxplot Together
df_ill_Week_Tog_Box<-bind_rows(df_ill_Week_ON_Box_Prev,df_ill_Week_OFF_Box_Prev,df_ill_Week_ONWash_Box_Prev,df_ill_Week_ONWr_Box_Prev,df_ill_Week_OFFWash_Box_Prev,df_ill_Week_OFFWr_Box_Prev)
Ill_Prev_Comb<-ggplot(df_ill_Week_Tog_Box, aes(x = variable, y = Prev, fill=Int)) +
geom_boxplot() +
theme_bw()+
ylab("Prevalence of Ill Students")+
xlab("Week #") +
ggtitle("ST Status: Compaison Weekly Dose Response Distribution: Prevalence Ill Students")+
theme(plot.title = element_text(hjust = 0.5))+
labs(fill = "ST Status")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggsave(filename = "Ill_Prev_Comb.png", path = "Dose Response",width = 40,height = 10,)
print(Ill_Prev_Comb)
View(df_ill_Week_Tog_Box)
Ill_Prev_Comb<-ggplot(df_ill_Week_Tog_Box, aes( y = Prev, fill=Int)) +
geom_boxplot() +
theme_bw()+
ylab("Prevalence of Ill Students")+
xlab("Week #") +
ggtitle("ST Status: Compaison Weekly Dose Response Distribution: Prevalence Ill Students")+
theme(plot.title = element_text(hjust = 0.5))+
labs(fill = "Interventions")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggsave(filename = "Ill_Prev_Comb.png", path = "Dose Response",width = 40,height = 10,)
ggsave(filename = "Ill_Prev_Comb.png", path = "Dose Response",width = 40,height = 10,)
print(Ill_Prev_Comb)
Ill_Prev_Comb<-ggplot(df_ill_Week_Tog_Box, aes(x = variable, y = Prev, fill=Int)) +
geom_boxplot() +
theme_bw()+
ylab("Prevalence of Ill Students")+
xlab("Week #") +
ggtitle("ST Status: Compaison Weekly Dose Response Distribution: Prevalence Ill Students")+
theme(plot.title = element_text(hjust = 0.5))+
labs(fill = "Interventions")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggsave(filename = "Ill_Prev_Comb.png", path = "Dose Response",width = 40,height = 10,)
ggsave(filename = "Ill_Prev_Comb.png", path = "Dose Response",width = 40,height = 10,)
print(Ill_Prev_Comb)
Func_DF_Locations(){
ST_OFF_Analysis_Con<-Individual_Analysis_Fr_CopOFF
ST_ON_Analysis_Con<-Individual_Analysis_Fr_CopON
ST_ONWash_Analysis_Con<-Individual_Analysis_Fr_CopONWash
ST_ONWr_Analysis_Con<-Individual_Analysis_Fr_CopONWr
ST_OFFWash_Analysis_Con<-Individual_Analysis_Fr_CopOFFWash
ST_OFFWr_Analysis_Con<-Individual_Analysis_Fr_CopOFFWr
Total_Items_ON<-nrow(ST_ON_Analysis_Con)
Total_Items_OFF<-nrow(ST_OFF_Analysis_Con)
ST_OFF_Analysis_Con$Type<-"OFF"
ST_ON_Analysis_Con$Type<-"ON"
ST_ONWash_Analysis_Con$Type<-"ONWash"
ST_ONWr_Analysis_Con$Type<-"ONWr"
ST_OFFWash_Analysis_Con$Type<-"OFFWash"
ST_OFFWr_Analysis_Con$Type<-"OFFWr"
ST_Comb_Analysis_Con<-bind_rows(ST_OFF_Analysis_Con,ST_ON_Analysis_Con,ST_ONWash_Analysis_Con,ST_ONWr_Analysis_Con,ST_OFFWash_Analysis_Con,ST_OFFWr_Analysis_Con)
return(ST_Comb_Analysis_Con)
}
Func_DF_Locations<-function(){
ST_OFF_Analysis_Con<-Individual_Analysis_Fr_CopOFF
ST_ON_Analysis_Con<-Individual_Analysis_Fr_CopON
ST_ONWash_Analysis_Con<-Individual_Analysis_Fr_CopONWash
ST_ONWr_Analysis_Con<-Individual_Analysis_Fr_CopONWr
ST_OFFWash_Analysis_Con<-Individual_Analysis_Fr_CopOFFWash
ST_OFFWr_Analysis_Con<-Individual_Analysis_Fr_CopOFFWr
Total_Items_ON<-nrow(ST_ON_Analysis_Con)
Total_Items_OFF<-nrow(ST_OFF_Analysis_Con)
ST_OFF_Analysis_Con$Type<-"OFF"
ST_ON_Analysis_Con$Type<-"ON"
ST_ONWash_Analysis_Con$Type<-"ONWash"
ST_ONWr_Analysis_Con$Type<-"ONWr"
ST_OFFWash_Analysis_Con$Type<-"OFFWash"
ST_OFFWr_Analysis_Con$Type<-"OFFWr"
ST_Comb_Analysis_Con<-bind_rows(ST_OFF_Analysis_Con,ST_ON_Analysis_Con,ST_ONWash_Analysis_Con,ST_ONWr_Analysis_Con,ST_OFFWash_Analysis_Con,ST_OFFWr_Analysis_Con)
return(ST_Comb_Analysis_Con)
}
ST_Comb_Analysis_Con<-Func_DF_Location
ST_Comb_Analysis_Con<-Func_DF_Locations
ggplot(data =ST_Comb_Analysis_Con, aes(x = Type,fill=Location)  )+
geom_bar()+
geom_text(stat = "count",aes(label=..count..),position = position_stack(vjust = .5))
Func_DF_Locations<-function(){
ST_OFF_Analysis_Con<-Individual_Analysis_Fr_CopOFF
ST_ON_Analysis_Con<-Individual_Analysis_Fr_CopON
ST_ONWash_Analysis_Con<-Individual_Analysis_Fr_CopONWash
ST_ONWr_Analysis_Con<-Individual_Analysis_Fr_CopONWr
ST_OFFWash_Analysis_Con<-Individual_Analysis_Fr_CopOFFWash
ST_OFFWr_Analysis_Con<-Individual_Analysis_Fr_CopOFFWr
Total_Items_ON<-nrow(ST_ON_Analysis_Con)
Total_Items_OFF<-nrow(ST_OFF_Analysis_Con)
ST_OFF_Analysis_Con$Type<-"OFF"
ST_ON_Analysis_Con$Type<-"ON"
ST_ONWash_Analysis_Con$Type<-"ONWash"
ST_ONWr_Analysis_Con$Type<-"ONWr"
ST_OFFWash_Analysis_Con$Type<-"OFFWash"
ST_OFFWr_Analysis_Con$Type<-"OFFWr"
ST_Comb_Analysis_Con<-bind_rows(ST_OFF_Analysis_Con,ST_ON_Analysis_Con,ST_ONWash_Analysis_Con,ST_ONWr_Analysis_Con,ST_OFFWash_Analysis_Con,ST_OFFWr_Analysis_Con)
return(ST_Comb_Analysis_Con)
}
ST_Comb_Analysis_Con<-Func_DF_Locations
ST_Comb_Analysis_Con<-Func_DF_Locations()
ggplot(data =ST_Comb_Analysis_Con, aes(x = Type,fill=Location)  )+
geom_bar()+
geom_text(stat = "count",aes(label=..count..),position = position_stack(vjust = .5))
Func_DF_Histogram_Log<-function(AnalysisDF,Intervention){
#AnalysisDF = AnalysisDF
#Intervention= "OnOFF
ST_Analysis_Log<-AnalysisDF
ST__Analysis_Log$Contamination[ST_Analysis_Log$Contamination==0]<-(.99)
ST_Analysis_Log$Log<-log10(ST_Analysis_Log$Contamination)
ST_Analysis_Log$Category<-""
ST_Analysis_Log$OnOff<-Intervention
return(ST_Analysis_Log)
}
Func_DF_Histogram_Log<-function(AnalysisDF,Intervention){
#AnalysisDF = AnalysisDF
#Intervention= "OnOFF
ST_Analysis_Log<-AnalysisDF
ST__Analysis_Log$Contamination[ST_Analysis_Log$Contamination==0]<-(.99)
ST_Analysis_Log$Log<-log10(ST_Analysis_Log$Contamination)
ST_Analysis_Log$Category<-""
ST_Analysis_Log$OnOff<-Intervention
return(ST_Analysis_Log)
}
View(ST_ON_Analysis)
ST_ON_Analysis_Log<-Func_DF_Histogram_Log(AnalysisDF = ST_ON_Analysis,Intervention = "ON")
Func_DF_Histogram_Log<-function(AnalysisDF,Intervention){
#AnalysisDF = AnalysisDF
#Intervention= "OnOFF
ST_Analysis_Log<-AnalysisDF
ST_Analysis_Log$Contamination[ST_Analysis_Log$Contamination==0]<-(.99)
ST_Analysis_Log$Log<-log10(ST_Analysis_Log$Contamination)
ST_Analysis_Log$Category<-""
ST_Analysis_Log$OnOff<-Intervention
return(ST_Analysis_Log)
}
ST_ON_Analysis_Log<-Func_DF_Histogram_Log(AnalysisDF = ST_ON_Analysis,Intervention = "ON")
ST_OFF_Analysis_Log<-Func_DF_Histogram_Log(AnalysisDF = ST_OFF_Analysis,Intervention = "OFF")
ST_ONWash_Analysis_Log<-Func_DF_Histogram_Log(AnalysisDF = ST_ONWash_Analysis,Intervention = "ONWash")
ST_ONWr_Analysis_Log<-Func_DF_Histogram_Log(AnalysisDF = ST_ONWr_Analysis,Intervention = "ONWr")
ST_OFFWash_Analysis_Log<-Func_DF_Histogram_Log(AnalysisDF = ST_OFFWash_Analysis,Intervention = "OFFWash")
ST_OFFWr_Analysis_Log<-Func_DF_Histogram_Log(AnalysisDF = ST_OFFWr_Analysis,Intervention = "OFFWr")
ST_Comb_Analysis_Log<-bind_rows(ST_ON_Analysis_Log,ST_OFF_Analysis_Log,ST_ONWash_Analysis_Log,ST_ONWr_Analysis_Log,ST_OFFWash_Analysis_Log,ST_OFFWr_Analysis_Log)
Wrapped_Histograms<-ggplot(data = ST_Comb_Analysis_Log,aes(x=Log))+
geom_histogram(colour="black", alpha=.2,bins =15,boundary = -.001)+
facet_wrap(~ OnOff)+
scale_x_continuous( )+
xlab("Contamination log GEC/Item")+
ylab("Number of Students")+
ggtitle("Share Tables ON: Contamination distribution Consumed by Students")+
theme(plot.title = element_text(hjust = 0.5))+
stat_bin(aes(y=..count.., label=..count..), geom="text", vjust=-.2,bins=15, boundary = -.001,size=3)
ggsave(filename = "Wrapped_Histograms.png", path = "Dose Response",width = 10,height = 6,)
ggsave(filename = "Wrapped_Histograms.png", path = "Dose Response",width = 10,height = 6,)
print(Wrapped_Histograms)
Wrapped_Histograms<-ggplot(data = ST_Comb_Analysis_Log,aes(x=Log))+
geom_histogram(colour="black", alpha=.2,bins =15,boundary = -.001)+
facet_wrap(~ OnOff)+
scale_x_continuous( )+
xlab("Contamination log GEC/Item")+
ylab("Number of Students")+
ggtitle("Share Table Interventions: Contamination distribution Consumed by Students")+
theme(plot.title = element_text(hjust = 0.5))+
stat_bin(aes(y=..count.., label=..count..), geom="text", vjust=-.2,bins=15, boundary = -.001,size=3)
ggsave(filename = "Wrapped_Histograms.png", path = "Dose Response",width = 10,height = 6,)
ggsave(filename = "Wrapped_Histograms.png", path = "Dose Response",width = 10,height = 6,)
print(Wrapped_Histograms)
Func_DF_Histogram_Log<-function(AnalysisDF,Intervention){
#AnalysisDF = AnalysisDF
#Intervention= "OnOFF
ST_Analysis_Log<-AnalysisDF
ST_Analysis_Log$Contamination[ST_Analysis_Log$Contamination==0]<-(.99)
ST_Analysis_Log$Log<-log10(ST_Analysis_Log$Contamination)
ST_Analysis_Log$Category<-""
ST_Analysis_Log$OnOff<-Intervention
return(ST_Analysis_Log)
for (i in 1:nrow(ST_Analysis_Log)){
Conta<-as.numeric( ST_Analysis_Log$Contamination[i])
if(Conta == .99 ){
ST_Analysis_Log$Category[i] <-"0"
} else if(Conta >0 && Conta< 100 ){
ST_Analysis_Log$Category[i]  <-"<0 - 99"
}else if(Conta >= 100 && Conta < 1000 ){
ST_Analysis_Log$Category[i]  <-"100 - 999"
}else if(Conta >=1000 ){
ST_Analysis_Log$Category[i]  <-">=1000"
}
}
}
ST_ON_Analysis_Log<-Func_DF_Histogram_Log(AnalysisDF = ST_ON_Analysis,Intervention = "ON")
ST_OFF_Analysis_Log<-Func_DF_Histogram_Log(AnalysisDF = ST_OFF_Analysis,Intervention = "OFF")
ST_ONWash_Analysis_Log<-Func_DF_Histogram_Log(AnalysisDF = ST_ONWash_Analysis,Intervention = "ONWash")
ST_ONWr_Analysis_Log<-Func_DF_Histogram_Log(AnalysisDF = ST_ONWr_Analysis,Intervention = "ONWr")
ST_OFFWash_Analysis_Log<-Func_DF_Histogram_Log(AnalysisDF = ST_OFFWash_Analysis,Intervention = "OFFWash")
ST_OFFWr_Analysis_Log<-Func_DF_Histogram_Log(AnalysisDF = ST_OFFWr_Analysis,Intervention = "OFFWr")
ST_Comb_Analysis_Log<-bind_rows(ST_ON_Analysis_Log,ST_OFF_Analysis_Log,ST_ONWash_Analysis_Log,ST_ONWr_Analysis_Log,ST_OFFWash_Analysis_Log,ST_OFFWr_Analysis_Log)
Wrapped_Histograms<-ggplot(data = ST_Comb_Analysis_Log,aes(x=Log))+
geom_histogram(colour="black", alpha=.2,bins =15,boundary = -.001)+
facet_wrap(~ OnOff)+
scale_x_continuous( )+
xlab("Contamination log GEC/Item")+
ylab("Number of Students")+
ggtitle("Share Table Interventions: Contamination distribution Consumed by Students")+
theme(plot.title = element_text(hjust = 0.5))+
stat_bin(aes(y=..count.., label=..count..), geom="text", vjust=-.2,bins=15, boundary = -.001,size=3)
ggsave(filename = "Wrapped_Histograms.png", path = "Dose Response",width = 10,height = 6,)
ggsave(filename = "Wrapped_Histograms.png", path = "Dose Response",width = 10,height = 6,)
print(Wrapped_Histograms)
View(ST_Comb_Analysis_Con)
Func_DF_Histogram_Log<-function(AnalysisDF,Intervention){
#AnalysisDF = AnalysisDF
#Intervention= "OnOFF
ST_Analysis_Log<-AnalysisDF
ST_Analysis_Log$Contamination[ST_Analysis_Log$Contamination==0]<-(.99)
ST_Analysis_Log$Log<-log10(ST_Analysis_Log$Contamination)
ST_Analysis_Log$Category<-""
ST_Analysis_Log$OnOff<-Intervention
for (i in 1:nrow(ST_Analysis_Log)){
Conta<-as.numeric( ST_Analysis_Log$Contamination[i])
if(Conta == .99 ){
ST_Analysis_Log$Category[i] <-"0"
} else if(Conta >0 && Conta< 100 ){
ST_Analysis_Log$Category[i]  <-"<0 - 99"
}else if(Conta >= 100 && Conta < 1000 ){
ST_Analysis_Log$Category[i]  <-"100 - 999"
}else if(Conta >=1000 ){
ST_Analysis_Log$Category[i]  <-">=1000"
}
}
return(ST_Analysis_Log)
}
ST_ON_Analysis_Log<-Func_DF_Histogram_Log(AnalysisDF = ST_ON_Analysis,Intervention = "ON")
ST_OFF_Analysis_Log<-Func_DF_Histogram_Log(AnalysisDF = ST_OFF_Analysis,Intervention = "OFF")
ST_ONWash_Analysis_Log<-Func_DF_Histogram_Log(AnalysisDF = ST_ONWash_Analysis,Intervention = "ONWash")
ST_ONWr_Analysis_Log<-Func_DF_Histogram_Log(AnalysisDF = ST_ONWr_Analysis,Intervention = "ONWr")
ST_OFFWash_Analysis_Log<-Func_DF_Histogram_Log(AnalysisDF = ST_OFFWash_Analysis,Intervention = "OFFWash")
ST_OFFWr_Analysis_Log<-Func_DF_Histogram_Log(AnalysisDF = ST_OFFWr_Analysis,Intervention = "OFFWr")
ST_Comb_Analysis_Log<-bind_rows(ST_ON_Analysis_Log,ST_OFF_Analysis_Log,ST_ONWash_Analysis_Log,ST_ONWr_Analysis_Log,ST_OFFWash_Analysis_Log,ST_OFFWr_Analysis_Log)
View(ST_Comb_Analysis_Log)
Wrapped_Histograms<-ggplot(data = ST_Comb_Analysis_Log,aes(x=Log))+
geom_histogram(colour="black", alpha=.2,bins =15,boundary = -.001)+
facet_wrap(~ OnOff)+
scale_x_continuous( )+
xlab("Contamination log GEC/Item")+
ylab("Number of Students")+
ggtitle("Share Table Interventions: Contamination distribution Consumed by Students")+
theme(plot.title = element_text(hjust = 0.5))+
stat_bin(aes(y=..count.., label=..count..), geom="text", vjust=-.2,bins=15, boundary = -.001,size=3)
ggsave(filename = "Wrapped_Histograms.png", path = "Dose Response",width = 10,height = 6,)
ggsave(filename = "Wrapped_Histograms.png", path = "Dose Response",width = 10,height = 6,)
print(Wrapped_Histograms)
Func_DF_Barplot_Log<-function(ST_Analysis_Log){
PlotOrder<-c("0","<0 - 99","100 - 999",">=1000")
ST_Analysis_Log %>%
count(Category) %>%
mutate(perc = n / nrow(ST_Analysis_Log)) %>%
slice(match(Category,PlotOrder))-> tips2
tips2$OnOff<-"ON"
return(tips2)
}
Func_DF_Barplot_Log<-function(ST_Analysis_Log,Intervention){
PlotOrder<-c("0","<0 - 99","100 - 999",">=1000")
ST_Analysis_Log %>%
count(Category) %>%
mutate(perc = n / nrow(ST_Analysis_Log)) %>%
slice(match(Category,PlotOrder))-> tips2
tips2$OnOff<-Intervention
return(tips2)
}
tipsON<-Func_DF_Barplot_Log(ST_Analysis_Log = ST_ON_Analysis_Log, Intervention = "ON")
tipsOFF<-Func_DF_Barplot_Log(ST_Analysis_Log = ST_OFF_Analysis_Log,Intervention = "OFF")
tipsONWash<-Func_DF_Barplot_Log(ST_Analysis_Log = ST_ONWash_Analysis_Log,Intervention = "ONWash")
tipsONWr<-Func_DF_Barplot_Log(ST_Analysis_Log = ST_ONWr_Analysis_Log,Intervention = "ONWr")
tipsOFFWash<-Func_DF_Barplot_Log(ST_Analysis_Log = ST_OFFWash_Analysis_Log,Intervention = "OFFWash")
tipsOFFWr<-Func_DF_Barplot_Log(ST_Analysis_Log = ST_OFFWr_Analysis_Log,Intervention = "OFFWr")
tips4<-bind_rows(tipsON,tipsOFF,tipsONWash,tipsONWr,tipsOFFWash, tipsOFFWr)
ggplot(data =tips4, aes(x = OnOff,y=perc, fill=factor(Category, levels=c("0","<0 - 99","100 - 999",">=1000"))))+
geom_col(width = .2)+
geom_text_repel(aes(x = OnOff,
y = perc,
label = paste(round(perc*100,2),"%")),nudge_y = -.2, nudge_x = .15, direction = "x")+
geom_text_repel(aes(x = OnOff,
y = perc,
label = n),nudge_x = -.15,nudge_y = -.2, direction = "x")+
labs(fill = "Category")+
scale_x_discrete(expand = c(.5, 0))+
coord_flip()+
xlab(label = "Share Table Status")+
ylab(label = "")+
ggtitle("Composition on Exposure of Individual Students (%)")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data =tips4, aes(x = OnOff,y=perc, fill=factor(Category, levels=c("0","<0 - 99","100 - 999",">=1000"))))+
geom_col(width = .5)+
geom_text_repel(aes(x = OnOff,
y = perc,
label = paste(round(perc*100,2),"%")),nudge_y = -.2, nudge_x = .15, direction = "x")+
geom_text_repel(aes(x = OnOff,
y = perc,
label = n),nudge_x = -.15,nudge_y = -.2, direction = "x")+
labs(fill = "Category")+
scale_x_discrete(expand = c(.5, 0))+
coord_flip()+
xlab(label = "Share Table Status")+
ylab(label = "")+
ggtitle("Composition on Exposure of Individual Students (%)")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data =tips4, aes(x = OnOff,y=perc, fill=factor(Category, levels=c("0","<0 - 99","100 - 999",">=1000"))))+
geom_col(width = 1)+
geom_text_repel(aes(x = OnOff,
y = perc,
label = paste(round(perc*100,2),"%")),nudge_y = -.2, nudge_x = .15, direction = "x")+
geom_text_repel(aes(x = OnOff,
y = perc,
label = n),nudge_x = -.15,nudge_y = -.2, direction = "x")+
labs(fill = "Category")+
scale_x_discrete(expand = c(.5, 0))+
coord_flip()+
xlab(label = "Share Table Status")+
ylab(label = "")+
ggtitle("Composition on Exposure of Individual Students (%)")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data =tips4, aes(x = OnOff,y=perc, fill=factor(Category, levels=c("0","<0 - 99","100 - 999",">=1000"))))+
geom_col(width = .7)+
geom_text_repel(aes(x = OnOff,
y = perc,
label = paste(round(perc*100,2),"%")),nudge_y = -.2, nudge_x = .15, direction = "x")+
geom_text_repel(aes(x = OnOff,
y = perc,
label = n),nudge_x = -.15,nudge_y = -.2, direction = "x")+
labs(fill = "Category")+
scale_x_discrete()+
coord_flip()+
xlab(label = "Share Table Status")+
ylab(label = "")+
ggtitle("Composition on Exposure of Individual Students (%)")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data =tips4, aes(x = OnOff,y=perc, fill=factor(Category, levels=c("0","<0 - 99","100 - 999",">=1000"))))+
geom_col(width = .7)+
geom_text_repel(aes(x = OnOff,
y = perc,
label = paste(round(perc*100,2),"%")),nudge_y = -.2, nudge_x = .15, direction = "x")+
geom_text_repel(aes(x = OnOff,
y = perc,
label = n),nudge_x = -.10,nudge_y = -.2, direction = "x")+
labs(fill = "Category")+
scale_x_discrete()+
coord_flip()+
xlab(label = "Share Table Status")+
ylab(label = "")+
ggtitle("Composition on Exposure of Individual Students (%)")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data =tips4, aes(x = OnOff,y=perc, fill=factor(Category, levels=c("0","<0 - 99","100 - 999",">=1000"))))+
geom_col(width = .7)+
geom_text_repel(aes(x = OnOff,
y = perc,
label = paste(round(perc*100,2),"%")),nudge_y = -.2, nudge_x = .15, direction = "x")+
geom_text_repel(aes(x = OnOff,
y = perc,
label = n),nudge_x = -.10,nudge_y = -.1, direction = "x")+
labs(fill = "Category")+
scale_x_discrete()+
coord_flip()+
xlab(label = "Share Table Status")+
ylab(label = "")+
ggtitle("Composition on Exposure of Individual Students (%)")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data =tips4, aes(x = OnOff,y=perc, fill=factor(Category, levels=c("0","<0 - 99","100 - 999",">=1000"))))+
geom_col(width = .7)+
geom_text_repel(aes(x = OnOff,
y = perc,
label = paste(round(perc*100,2),"%")),nudge_y = -.1, nudge_x = .15, direction = "x")+
geom_text_repel(aes(x = OnOff,
y = perc,
label = n),nudge_x = -.10,nudge_y = -.1, direction = "x")+
labs(fill = "Category")+
scale_x_discrete()+
coord_flip()+
xlab(label = "Share Table Status")+
ylab(label = "")+
ggtitle("Composition on Exposure of Individual Students (%)")+
theme(plot.title = element_text(hjust = 0.5))
