print(rate)
Time = 175
(rate*Time)
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Temp<-2.1
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Temp<-2.7
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Time = 175
(rate*Time)
#P Putida
bval = 0.03772 #+-0.0002
T_min = -6.1
Coef= 0.1719#+-1.22 C
Tmax<-41.2
Temp<-2.7
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Time = 175
(rate*Time)
#P Putida
bval = 0.03347 #+-0.0002
T_min = -7.7
Coef= 0.1719#+-1.22 C
Tmax<-41.2
Temp<-2.7
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Time = 175
(rate*Time)
Temp<-10
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2*log10(2)
print(rate)
Temp<-15
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2*log10(2)
print(rate)
Temp<-25
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2*log10(2)
print(rate)
Time = 175
Temp<-4
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2*log10(2)
print(rate)
Time = 175
(rate*Time)
log(10)
adrate = rate/log(10)
print(rate)
Temp<-5
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2
adrate = rate/log(10)
print(rate)
Time = 175
(rate*Time)
Temp<-5
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2
adrate = rate/log(10)
print(adrate)
Time = 175
(adrate*Time)
log(10)
log(2)
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2
print(rate)
print(adrate)
print(adrate2)
adrate2 = rate*ln(2)
print(adrate2)
adrate2 = rate*log(2)
print(adrate2)
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2
print(rate)
adrate = rate/log(10)
print(adrate)
adrate2 = rate*log(2)
print(adrate2)
log(10)
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2
print(rate)
adrate = rate/log(10)
print(adrate)
adrate2 = rate*log(2)
print(adrate2)
log(2)
adrate2 = rate*log10(2)
print(adrate2)
adrate2 = rate*log(2)
print(adrate2)
#Validation of their model, obtaining similar Histograms as theirs for spoilage
shelf_life<-c()
for (i in 1:1000){
Temp<-rnorm(1,4.4,2)
Growth_variability <- 1-(rnorm(1,0,17)/100)
Initial_pop <- rtriang(1,0,1,4)
GrowthNeedforspoilage<-7-Initial_pop
Tmin <- -1.19
bval <-0.03578
growthRate <- ((Temp-Tmin)*bval)^2
Adjusted_GrowthRate<-growthRate+Growth_variability
LogGrowthRate<-Adjusted_GrowthRate*log10(2)
Shelflifedays<-(GrowthNeedforspoilage/LogGrowthRate)
shelf_life<-c(shelf_life,Shelflifedays)
}
hist(shelf_life,breaks = 100)
abline(v=14, col = "red")
mean(shelf_life)
log10(20000)
log10(1000000)
bval = 0.03347 #+-0.0002
T_min = -7.7
Temp 4
rate = (bval*(Temp-T_min))^2
bval <- 0.03347 #+-0.0002
T_min <- -7.7
Temp<- 4
rate = (bval*(Temp-T_min))^2
lagtime = 1/((bval*(Temp-T_min))^2)
lagtime
rate
Time<-10
rate = (bval*(Temp-T_min))^2
Spoilage<-rate*Time
Spoilage
rate/24
Temp<- 10
rate = (bval*(Temp-T_min))^2
rate/24
Temp<- 25
rate = (bval*(Temp-T_min))^2
rate*Time
Time<-3
rate*Time
Temp<- 25
rate = 0.1709*(Temp+6.1)*(1-exp(0.1723*(Temp-41.2)))*(0.996-0.977)
rate
rate*Time
Time<-24
rate = 0.1709*(Temp+6.1)*(1-exp(0.1723*(Temp-41.2)))*(0.996-0.977)
rate*Time
rate = 0.1709*(Temp+6.1)*(1-exp(0.1723*(Temp-41.2)))*(0.996-0.977)
Temp = 25
Temp = 25
Time = 24
rate = 0.1709*(Temp+6.1)*(1-exp(0.1723*(Temp-41.2)))*(0.996-0.977)
rate*Time
rate = 0.1539*(Temp+7.6)*(0.996-0.947)
rate*Time
rate = 0.1539*(Temp+7.6)*0.996-0.947
rate*Time
rate = 0.1539*(Temp+7.6)*(0.996-0.947)
rate*Time
Temp<- 4
rate = (bval*(Temp-T_min))^2
rate
Temp<- 4
rate = (bval*(Temp-T_min))^2
rate
rate = (bval*(Temp-T_min))^2/2.303
rate
Temp<- 15
rate = (bval*(Temp-T_min))^2/2.303
rate
Temp<- 29
rate = (bval*(Temp-T_min))^2/2.303
rate
T_min <- -9.1
Temp<- 29
rate = (bval*(Temp-T_min))^2/2.303
rate
T_min <- -7.7
Temp<- 5
rate = (bval*(Temp-T_min))^2/2.303
rate
Temp<- 4
rate = (bval*(Temp-T_min))^2/2.303
rate
LagTime = 1/rate
LagTime
Temp<- 25
rate = (bval*(Temp-T_min))^2/2.303
rate
LagTime = 1/rate
LagTime
bval <-0.023
Tmin <--5.647
#ratemax<-(bval*(Temp-T_min))
sqrtrate<-c()
for (i in -5:35){
ratemax<-(bval*(i-T_min))
sqrtrate<-c(sqrtrate,ratemax)
}
sqrtrate<-c()
Timeseq<-seq(-5,35)
for (i in Timeseq){
ratemax<-(bval*(i-T_min))
sqrtrate<-c(sqrtrate,ratemax)
}
plot(x = Timeseq, y = sqrtrate)
sqrtrate<-c()
Timeseq<-seq(-5,35)
for (i in Timeseq){
ratemax<-(bval*(i-T_min))^2
sqrtrate<-c(sqrtrate,ratemax)
}
plot(x = Timeseq, y = sqrtrate)
#Ratworsky
bval <-0.023
Tmin <--5.647
Temp<-4
ratemax<-(bval*(Temp-T_min))
ratemax
#Ratworsky
bval <-0.023
Tmin <--5.647
Temp<-4
ratemax<-(bval*(Temp-T_min))^2
ratemax
Temp<-4
ratemax<-(bval*(Temp-T_min))
ratemax
#Ratworsky
bval <-0.023
Tmin <--5.647
Temp<-4
ratemax<-(bval*(Temp-T_min))
ratemax
sqrtrate<-c()
sqrtrate<-c()
Timeseq<-seq(-5,35)
for (i in Timeseq){
ratemax<-(bval*(i-T_min))
sqrtrate<-c(sqrtrate,ratemax)
}
plot(x = Timeseq, y = sqrtrate)
Temp<-4
ratemax<-(bval*(Temp-T_min))^2
ratemax
ratemax<-(bval*(Temp-T_min))^2/2.303
ratemax
#Ratworsky
bval <-0.023
Tmin <--5.647
Temp<-10
ratemax<-(bval*(Temp-T_min))^2/2.303
ratemax
#Ratworsky
bval <-0.023
Tmin <--5.647
Temp<-10
ratemax<-(bval*(Temp-T_min))^2/log(10)
ratemax
bval <- 0.03347 #+-0.0002
T_min <- -7.7
Temp<- 4
Time<-24
Temp<- 25
rate = (bval*(Temp-T_min))^2/2.303
rate
LagTime = 1/rate
LagTime
rate
Time<-24
Temp<- 4
rate = (bval*(Temp-T_min))^2/2.303
rate
LagTime = 1/rate
LagTime
1/0.35
1/0.035
1/1.1
runif(1,20,30)
runif(1,20,30)
library(ppcor)
library(sensitivity)
library(ggplot2)
library(randomForest)
Data <- read.csv("SensitivityOut.csv", stringsAsFactors = TRUE)
Data<-Data[-c(1)]
PCC1<-pcc(X = Data[,1:7], y=Data$TotalCFUFP, rank =TRUE, conf = 0.95, nboot = 1000)
plot(PCC1)
#8 Visuals , remaing the columns to that no error in ggplot
names(PCC1$PRCC)=c("original", "bias" ,"std.error", "minci","maxci")
#Ggplot, here is similar to a tornado plot. Also there are error bars on the 95th percentile
pairs(Data)
load("C:/Users/gareyes3/Box Sync/Share Table Project/QMRA Files/QMRA Paper/Final Analyses R Files Data/6-28 Large Data.RData")
#Setting Working Directory-------------------------------------
setwd("C:/Users/gareyes3/Documents/GitHub/Share-Table-QMRA/R")
#Opening Libary and Inputs-------------------------------------
source("Util_Library.R")
source("Functions_Full_Analysis.R")
source("Util_FunctionFoodWaste.R")
#With Percentages
ggplot(data = FoodWaste_Analysis_melted_PCT, aes(x= Treatment,y=value, fill= factor(variable, levels  = c("TotalReserviced", "TotalDiscarded", "ConsumedSel", "ConsumedST"))))+
geom_col()+
scale_x_discrete(labels=c("XClosed"="Re-Service Off",
"OFF" = "Traditional",
"ON"= "Share Table",
'XAside' = 'One-way ST',
'XExc' = 'Ill Exclusion'
))+
ylab("Number of Items")+
xlab("Scenario Name")+
theme_bw()+
labs(fill = "Locations")+
ggtitle("Food Security: Item final location per scenario")+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=15))+
scale_fill_grey(name = "Location Categories", labels = labelsFW, start = 0.3, end =0.8)+
theme(legend.position="right")+
#geom_text(aes(label=value), size=5, position= position_stack(vjust=0.5))+
geom_text(aes(label = scales::percent(pct)),position= position_stack(vjust=0.5),col="black",size=5)
FoodWaste_Analysis_melted_PCT<-FoodWaste_Analysis_melted%>%
group_by(Treatment) %>%
mutate(pct=prop.table(value))
ggplot(data = FoodWaste_Analysis_melted_PCT, aes(x= Treatment,y=value, fill= factor(variable, levels  = c("TotalReserviced", "TotalDiscarded", "ConsumedSel", "ConsumedST"))))+
geom_col()+
scale_x_discrete(labels=c("XClosed"="Re-Service Off",
"OFF" = "Traditional",
"ON"= "Share Table",
'XAside' = 'One-way ST',
'XExc' = 'Ill Exclusion'
))+
ylab("Number of Items")+
xlab("Scenario Name")+
theme_bw()+
labs(fill = "Locations")+
ggtitle("Food Security: Item final location per scenario")+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=15))+
scale_fill_grey(name = "Location Categories", labels = labelsFW, start = 0.3, end =0.8)+
theme(legend.position="right")+
#geom_text(aes(label=value), size=5, position= position_stack(vjust=0.5))+
geom_text(aes(label = scales::percent(pct)),position= position_stack(vjust=0.5),col="black",size=5)
View(FoodWaste_Analysis)
View(Individual_Analysis_Fr_CopOFF)
Analysis_1<-func_remove_repeats(Individual_Analysis_Fr_CopOFF)
View(Analysis_1)
Analysis_1 %>% group_by(Week) %>%
summarise(sum())
Analysis_1 %>% group_by(Week) %>%
summarise(count)
Analysis_1 %>% group_by(week) %>%
summarise(sum(Location =="Consumed"))
Analysis_1 %>% group_by(week) %>%
summarise(Consumed = sum(Location =="Consumed"))
Analysis_1 %>% group_by(week) %>%
summarise(Consumed = sum(Location =="Consumed"),
Discarded = sum(Location =="Discarded"),
Reserviced = sum(Reserviced>0),
)
Analysis_1 %>% group_by(week) %>%
summarise(Consumed = sum(Location =="Consumed"),
Discarded = sum(Location =="Discarded"),
Reserviced = sum(Reserviced>0),
Consumed_Sel = sum(ConsumedAt=="ServiceLine" && STtimes>0 )
)
Analysis_1 %>% group_by(week) %>%
summarise(Consumed = sum(Location =="Consumed"),
Discarded = sum(Location =="Discarded"),
Reserviced = sum(Reserviced>0),
Consumed_Sel = sum(ConsumedAt=="ServiceLine")
)
Analysis_1 %>% group_by(week) %>%
summarise(Consumed = sum(Location =="Consumed"),
Discarded = sum(Location =="Discarded"),
Reserviced = sum(Reserviced>0),
Consumed_Sel = sum(ConsumedAt=="ServiceLine"),
Consumed_ST  = sum(ConsumedAt=="ShareTable")
)
Analysis_1 %>% group_by(week) %>%
summarise(Consumed = sum(Location =="Consumed"),
Discarded = sum(Location =="Discarded"),
Reserviced = sum(Reserviced>0),
Consumed_Sel = sum(ConsumedAt=="ServiceLine"),
Consumed_ST  = sum(ConsumedAt=="ShareTable")
)
ST_OFF_Summary<-Analysis_1 %>% group_by(week) %>%
summarise(Consumed = sum(Location =="Consumed"),
Discarded = sum(Location =="Discarded"),
Reserviced = sum(Reserviced>0),
Consumed_Sel = sum(ConsumedAt=="ServiceLine"),
Consumed_ST  = sum(ConsumedAt=="ShareTable")
)
ST_OFF_Summary<-Analysis_1 %>%
func_remove_repeats() %>%
group_by(week) %>%
summarise(Consumed = sum(Location =="Consumed"),
Discarded = sum(Location =="Discarded"),
Reserviced = sum(Reserviced>0),
Consumed_Sel = sum(ConsumedAt=="ServiceLine"),
Consumed_ST  = sum(ConsumedAt=="ShareTable")
)
ST_OFF_Summary<-Individual_Analysis_Fr_CopOFF %>%
func_remove_repeats() %>%
group_by(week) %>%
summarise(Consumed = sum(Location =="Consumed"),
Discarded = sum(Location =="Discarded"),
Reserviced = sum(Reserviced>0),
Consumed_Sel = sum(ConsumedAt=="ServiceLine"),
Consumed_ST  = sum(ConsumedAt=="ShareTable")
)
View(FoodWaste_Analysis)
(349474-161365)/349474
ST_OFF_Summary<-Individual_Analysis_Fr_CopOFF %>%
func_remove_repeats() %>%
group_by(week) %>%
summarise(Consumed = sum(Location =="Consumed"),
Discarded = sum(Location =="Discarded"),
Reserviced = sum(Reserviced>0),
Consumed_Sel = sum(ConsumedAt=="ServiceLine"),
Consumed_ST  = sum(ConsumedAt=="ShareTable")
)
ST_ON_Summary <-Individual_Analysis_Fr_CopON %>%
func_remove_repeats() %>%
group_by(week) %>%
summarise(Consumed = sum(Location =="Consumed"),
Discarded = sum(Location =="Discarded"),
Reserviced = sum(Reserviced>0),
Consumed_Sel = sum(ConsumedAt=="ServiceLine"),
Consumed_ST  = sum(ConsumedAt=="ShareTable")
)
Differences_Landfilled<-(ST_OFF_Summary$Discarded-ST_ON_Summary$Discarded)/ST_OFF_Summary$Discarded
mean(Differences_Landfilled)
quantiles(Differences_Landfilled<)
quantiles(Differences_Landfilled)
quantile(Differences_Landfilled)
quantile(Differences_Landfilled, c(0.025,0.975))
694913-573365/694913
(694913-573365)/694913
573365-694913/573365
(573365-694913)/573365
Difference_Consumed<-(ST_OFF_Summary$Consumed-ST_ON_Summary$Consumed)/ST_OFF_Summary$Consumed
quantile(Difference_Consumed, c(0.025,0.975))
hist(Difference_Consumed)
ST_OFF_Summary<-Individual_Analysis_Fr_CopOFF %>%
func_remove_repeats() %>%
group_by(week) %>%
summarise(Consumed = sum(Location =="Consumed"),
Discarded = sum(Location =="Discarded"),
Reserviced = sum(Reserviced>0),
Consumed_Sel = sum(ConsumedAt=="ServiceLine"),
Consumed_ST  = sum(ConsumedAt=="ShareTable"),
Total = nrow()
)
ST_ON_Summary <-Individual_Analysis_Fr_CopON %>%
func_remove_repeats() %>%
group_by(week) %>%
summarise(Consumed = sum(Location =="Consumed"),
Discarded = sum(Location =="Discarded"),
Reserviced = sum(Reserviced>0),
Consumed_Sel = sum(ConsumedAt=="ServiceLine"),
Consumed_ST  = sum(ConsumedAt=="ShareTable"),
Total = nrow()
)
ST_OFF_Summary<-Individual_Analysis_Fr_CopOFF %>%
func_remove_repeats() %>%
group_by(week) %>%
summarise(Consumed = sum(Location =="Consumed"),
Discarded = sum(Location =="Discarded"),
Reserviced = sum(Reserviced>0),
Consumed_Sel = sum(ConsumedAt=="ServiceLine"),
Consumed_ST  = sum(ConsumedAt=="ShareTable"),
Total = count()
)
ST_OFF_Summary<-Individual_Analysis_Fr_CopOFF %>%
func_remove_repeats() %>%
group_by(week) %>%
summarise(Consumed = sum(Location =="Consumed"),
Discarded = sum(Location =="Discarded"),
Reserviced = sum(Reserviced>0),
Consumed_Sel = sum(ConsumedAt=="ServiceLine"),
Consumed_ST  = sum(ConsumedAt=="ShareTable"),
Total = n()
)
ST_ON_Summary <-Individual_Analysis_Fr_CopON %>%
func_remove_repeats() %>%
group_by(week) %>%
summarise(Consumed = sum(Location =="Consumed"),
Discarded = sum(Location =="Discarded"),
Reserviced = sum(Reserviced>0),
Consumed_Sel = sum(ConsumedAt=="ServiceLine"),
Consumed_ST  = sum(ConsumedAt=="ShareTable"),
Total = n()
)
Difference_Used<-(ST_OFF_Summary$Total-ST_ON_Summary$Total)/ST_OFF_Summary$Total
quantile(Difference_Used, c(0.025,0.975))
histDifference_Used)
hist(Difference_Used)
save.image("C:/Users/gareyes3/Box Sync/Share Table Project/QMRA Files/QMRA Paper/Final Analyses R Files Data/FoodWasteRanges.RData")
