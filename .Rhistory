}
Contamination_Dataframe<-data.frame(
"Trial"<-1:500,
"Other"<-"",
stringsAsFactors = FALSE
)
View(Contamination_Dataframe)
Contamination_Dataframe<-data.frame(
Trial<-1:500,
Other<-"",
stringsAsFactors = FALSE
)
View(Contamination_Dataframe)
Contamination_Dataframe<-data.frame(
"Trial"=1:500,
"Other" = "",
stringsAsFactors = FALSE
)
View(Contamination_Dataframe)
for (i in 1:nrow(Contamination_Dataframe)){
Surface_hands<- 98  #cm^2
mass_feces_hands<- rbetagen(1,4.57,2.55,-8.00,-1.00) #log(g/hands)
HU_NV_in_Feces<- rlnormTrunc(1,6.65,2.06,0.0,10.98) #log HuNov CG/ g
Hu_NV_restroom<- runif(1,0,2) #log HUNOV/cm2
TE_RH<- rtriang(1,.036,.07,.22)
Genomic_copies_per_PFU<-rnormTrunc(1,3.65,.98,2.00,5.40)
Personal_Contamination<-((10^mass_feces_hands) * (10^HU_NV_in_Feces))/(10^Genomic_copies_per_PFU) #PFU/Hand
Environmental_Cont<-(10^Hu_NV_restroom) * (Surface_hands) * TE_RH
NV_from_Restroom<-(Personal_Contamination+Environmental_Cont)
Contamination_Dataframe[i,colnames(Contamination_Dataframe)=="Other"]<-NV_from_Restroom
}
View(Contamination_Dataframe)
hist(Contamination_Dataframe$Other)
Contamination_Dataframe<-data.frame(
"Trial"=1:500,
"Other" = "",
stringsAsFactors = FALSE
)
for (i in 1:nrow(Contamination_Dataframe)){
Surface_hands<- 98  #cm^2
mass_feces_hands<- rbetagen(1,4.57,2.55,-8.00,-1.00) #log(g/hands)
HU_NV_in_Feces<- rlnormTrunc(1,6.65,2.06,0.0,10.98) #log HuNov CG/ g
Hu_NV_restroom<- runif(1,0,2) #log HUNOV/cm2
TE_RH<- rtriang(1,.036,.07,.22)
Genomic_copies_per_PFU<-rnormTrunc(1,3.65,.98,2.00,5.40)
Personal_Contamination<-((10^mass_feces_hands) * (10^HU_NV_in_Feces))/(10^Genomic_copies_per_PFU) #PFU/Hand
Environmental_Cont<-(10^Hu_NV_restroom) * (Surface_hands) * TE_RH
NV_from_Restroom<-(Personal_Contamination+Environmental_Cont)
Contamination_Dataframe[i,colnames(Contamination_Dataframe)=="Other"]<-as.numeic(NV_from_Restroom)
}
Contamination_Dataframe<-data.frame(
"Trial"=1:500,
"Other" = "",
stringsAsFactors = FALSE
)
for (i in 1:nrow(Contamination_Dataframe)){
Surface_hands<- 98  #cm^2
mass_feces_hands<- rbetagen(1,4.57,2.55,-8.00,-1.00) #log(g/hands)
HU_NV_in_Feces<- rlnormTrunc(1,6.65,2.06,0.0,10.98) #log HuNov CG/ g
Hu_NV_restroom<- runif(1,0,2) #log HUNOV/cm2
TE_RH<- rtriang(1,.036,.07,.22)
Genomic_copies_per_PFU<-rnormTrunc(1,3.65,.98,2.00,5.40)
Personal_Contamination<-((10^mass_feces_hands) * (10^HU_NV_in_Feces))/(10^Genomic_copies_per_PFU) #PFU/Hand
Environmental_Cont<-(10^Hu_NV_restroom) * (Surface_hands) * TE_RH
NV_from_Restroom<-(Personal_Contamination+Environmental_Cont)
Contamination_Dataframe[i,colnames(Contamination_Dataframe)=="Other"]<-as.numeric(NV_from_Restroom)
}
hist(Contamination_Dataframe$Other)
hist(x = Contamination_Dataframe$Other)
View(Contamination_Dataframe)
?hist
class(Contamination_Dataframe$Other)
class(NV_from_Restroom)
Contamination_Dataframe[i,colnames(Contamination_Dataframe)=="Other"]<-as.numeric(NV_from_Restroom)
class(Contamination_Dataframe$Other)
class(NV_from_Restroom)
class(Contamination_Dataframe$Other[,3])
class(Contamination_Dataframe$Other[1])
as.numeric(Contamination_Dataframe$Other)
class(Contamination_Dataframe$Other)
class(Contamination_Dataframe$Other)
as.numeric(Contamination_Dataframe$Other)
contamination_Dataframe$other<-as.numeric(Contamination_Dataframe$Other)
Contamination_Dataframe$other<-as.numeric(Contamination_Dataframe$Other)
class(Contamination_Dataframe$Other)
ggplot(Contamination_Dataframe, aes(Other, Count))
ggplot(Contamination_Dataframe, aes(Other, count))
+ geom_histogram()
ggplot(Contamination_Dataframe, aes(Other, count))
ggplot(Contamination_Dataframe, aes(x = Other))
ggplot(Contamination_Dataframe, aes(x = Other))
+ geom_histogram()
ggplot(Contamination_Dataframe, aes(x = Other))
ggplot(Contamination_Dataframe, aes(x = Other))
+ geom_histogram(alpha = 0.5, position = 'identity', boundary=-1, binwidth = 1 )
ggplot(Contamination_Dataframe, aes(x = Other))+
geom_histogram(alpha = 0.5, position = 'identity', boundary=-1, binwidth = 1 )
ggplot(Contamination_Dataframe, aes(x = Other))+
geom_histogram()
ggplot(Contamination_Dataframe, aes(x = Other))+
geom_histogram(stat = count())
Contamination_Dataframe<-data.frame(
"Trial"=1:500,
"Other" = "",
stringsAsFactors = FALSE
)
Contamination_Dataframe<-data.frame(
"Trial"=1:500,
"Other" = as.numeric(0),
stringsAsFactors = FALSE
)
for (i in 1:nrow(Contamination_Dataframe)){
Surface_hands<- 98  #cm^2
mass_feces_hands<- rbetagen(1,4.57,2.55,-8.00,-1.00) #log(g/hands)
HU_NV_in_Feces<- rlnormTrunc(1,6.65,2.06,0.0,10.98) #log HuNov CG/ g
Hu_NV_restroom<- runif(1,0,2) #log HUNOV/cm2
TE_RH<- rtriang(1,.036,.07,.22)
Genomic_copies_per_PFU<-rnormTrunc(1,3.65,.98,2.00,5.40)
Personal_Contamination<-((10^mass_feces_hands) * (10^HU_NV_in_Feces))/(10^Genomic_copies_per_PFU) #PFU/Hand
Environmental_Cont<-(10^Hu_NV_restroom) * (Surface_hands) * TE_RH
NV_from_Restroom<-(Personal_Contamination+Environmental_Cont)
Contamination_Dataframe[i,colnames(Contamination_Dataframe)=="Other"]<-as.numeric(NV_from_Restroom)
}
class(Contamination_Dataframe$Other)
ggplot(Contamination_Dataframe, aes(x = Other))+
geom_histogram(stat = count())
hist(Contamination_Dataframe$Other)
?hist
hist(Contamination_Dataframe$Other, breaks = 50)
hist(Contamination_Dataframe$Other, breaks = 50, xlim = 200)
hist(Contamination_Dataframe$Other, breaks = 50, xlim = 200)
?hist
hist(Contamination_Dataframe$Other, breaks = 50, xlim = 2000)
hist(Contamination_Dataframe$Other, breaks = 50)
View(Contamination_Dataframe)
hist(Contamination_Dataframe$Other, breaks = 500)
hist(Contamination_Dataframe$Other, breaks = 20000)
boxplot(Contamination_Dataframe$Other)
Contamination_Dataframe<-data.frame(
"Trial"=1:500,
"Other" = as.numeric(0),
stringsAsFactors = FALSE
)
for (i in 1:nrow(Contamination_Dataframe)){
Surface_hands<- 98  #cm^2
mass_feces_hands<- rbetagen(1,4.57,2.55,-8.00,-1.00) #log(g/hands)
HU_NV_in_Feces<- rlnormTrunc(1,6.65,2.06,0.0,10.98) #log HuNov CG/ g
Hu_NV_restroom<- runif(1,0,2) #log HUNOV/cm2
TE_RH<- rtriang(1,.036,.07,.22)
Genomic_copies_per_PFU<-rnormTrunc(1,3.65,.98,2.00,5.40)
Personal_Contamination<-((10^mass_feces_hands) * (10^HU_NV_in_Feces))/(10^Genomic_copies_per_PFU) #PFU/Hand
Environmental_Cont<-(10^Hu_NV_restroom) * (Surface_hands) * TE_RH
NV_from_Restroom<-(Personal_Contamination+Environmental_Cont)
Contamination_Dataframe[i,colnames(Contamination_Dataframe)=="Other"]<-as.numeric(NV_from_Restroom)
}
hist(Contamination_Dataframe$Other, breaks = 20000)
boxplot(Contamination_Dataframe$Other)
hist(Contamination_Dataframe$Other, breaks = 20000)
mass_feces_hands<- rbetagen(500,4.57,2.55,-8.00,-1.00) #log(g/hands)
mean(mass_feces_hands)
sd(mass_feces_hands)
Contamination_Dataframe<-data.frame(
"Trial"=1:500,
"Other" = as.numeric(0),
stringsAsFactors = FALSE
)
for (i in 1:nrow(Contamination_Dataframe)){
Surface_hands<- 52  #cm^2
mass_feces_hands<- rbetagen(1,4.57,2.55,-8.00,-1.00) #log(g/hands)
HU_NV_in_Feces<- rlnormTrunc(1,6.65,2.06,0.0,10.98) #log HuNov CG/ g
Hu_NV_restroom<- runif(1,0,2) #log HUNOV/cm2
TE_RH<- rtriang(1,.036,.07,.22)
Genomic_copies_per_PFU<-rnormTrunc(1,3.65,.98,2.00,5.40)
Personal_Contamination<-((10^mass_feces_hands) * (10^HU_NV_in_Feces))/(10^Genomic_copies_per_PFU) #PFU/Hand
Environmental_Cont<-(10^Hu_NV_restroom) * (Surface_hands) * TE_RH
NV_from_Restroom<-(Personal_Contamination+Environmental_Cont)
Contamination_Dataframe[i,colnames(Contamination_Dataframe)=="Other"]<-as.numeric(NV_from_Restroom)
}
boxplot(Contamination_Dataframe$Other)
hist(Contamination_Dataframe$Other, breaks = 20000)
#Library
source("Library.R")
Temp<-4
Initial_pop<-lognormal(1,0.9)
Tempmin<-(-1.19)
b<-.03578
k<-((Temp-Tempmin)*b)^2
Conversion<-2^k
log10(Conversion)
Temp<-25
Initial_pop<-lognormal(1,0.9)
Tempmin<-(-1.19)
b<-.03578
k<-((Temp-Tempmin)*b)^2
Conversion<-2^k
New_K<-log10(Conversion)
Temp<-4
Initial_pop<-lognormal(1,0.9)
Tempmin<-(-1.19)
b<-.03578
k<-((Temp-Tempmin)*b)^2
Conversion<-2^k
New_K<-log10(Conversion)
New_K*504
Temp<-4
Initial_pop<-lognormal(1,0.9)
install.packages(c("EnvStats", "truncnorm"))
#Library
library("ggplot2")
library("reshape2")
library("mc2d")
library(dplyr)
library(deSolve)
library(brms)
library(truncnorm)
library("EnvStats")
Temp<-4
Initial_pop<-lognormal(1,0.9)
Temp<-4
Initial_pop<-lognormal(1,0.9)
library("mc2d")
Initial_pop<-rlnorm(1,1,0.9)
Temp<-4
Initial_pop<-rlnorm(1,1,0.9)
Tempmin<-(-1.19)
b<-.03578
k<-((Temp-Tempmin)*b)^2
Conversion<-2^k
New_K<-log10(Conversion)
New_K*504
Temp<-23
Initial_pop<-rlnorm(1,1,0.9)
Tempmin<-(-1.19)
b<-.03578
k<-((Temp-Tempmin)*b)^2
Conversion<-2^k
New_K<-log10(Conversion)
New_K*504
Temp<-4
Initial_pop<-rlnorm(1,1,0.9)
Tempmin<-(-1.19)
b<-.03578
k<-((Temp-Tempmin)*b)^2
Conversion<-2^k
New_K<-log10(Conversion)
New_K*504
Tempmin<-(-1.19)
b<-.03578
k<-((Temp-Tempmin)*b)^2
Conversion<-2^k
New_K<-log10(Conversion)
New_K*504
New_K<-log10(Conversion)
New_K*504
Variability<-(1-(rnorm(1,0,17)/100))
Temp<-4
Initial_pop<-rlnorm(1,1,0.9)
Tempmin<-(-1.19)
b<-.03578
k<-((Temp-Tempmin)*b)^2
Conversion<-2^k
New_K<-log10(Conversion)
6/New_K
577/24
Temp<-25
Initial_pop<-rlnorm(1,1,0.9)
Spoilage<-7
Growth_spoilage<-Spoilage-Initial_pop
Tempmin<-(-1.19)
b<-.03578
k<-((Temp-Tempmin)*b)^2
Variability<-(1-(rnorm(1,0,17)/100))
New_K<- k *Variability
Conversion<-2^New_K
New_K2<-log10(Conversion)
Shelf_Life<-Growth_spoilage/New_K2
Shelf_Life_days<-Shelf_Life/24
Temp<-4
Initial_pop<-rlnorm(1,1,0.9)
Spoilage<-7
Growth_spoilage<-Spoilage-Initial_pop
Tempmin<-(-1.19)
b<-.03578
k<-((Temp-Tempmin)*b)^2
Variability<-(1-(rnorm(1,0,17)/100))
New_K<- k *Variability
Conversion<-2^New_K
New_K2<-log10(Conversion)
Shelf_Life<-Growth_spoilage/New_K2
Shelf_Life_days<-Shelf_Life/24
Data_Frame_Milk<-data.frame(
Iteration = 1:500,
Shelflife =as.numeric(0),
stringsAsFactors = FALSE
)
for (i in 1:nrow(Data_Frame_Milk)){
Temp<-4
Initial_pop<-rlnorm(1,1,0.9)
Spoilage<-7
Growth_spoilage<-Spoilage-Initial_pop
Tempmin<-(-1.19)
b<-.03578
k<-((Temp-Tempmin)*b)^2
Variability<-(1-(rnorm(1,0,17)/100))
New_K<- k *Variability
Conversion<-2^New_K
New_K2<-log10(Conversion)
Shelf_Life<-Growth_spoilage/New_K2
Shelf_Life_days<-Shelf_Life/24
Data_Frame_Milk[i,colnames(Data_Frame_Milk)== "Shelflife"]<-Shelf_Life_days
}
View(Data_Frame_Milk)
hist(Data_Frame_Milk$Shelflife)
Data_Frame_Milk<-data.frame(
Iteration = 1:500,
Shelflife =as.numeric(0),
stringsAsFactors = FALSE
)
for (i in 1:nrow(Data_Frame_Milk)){
Temp<-rnorm(1,6.5,2)
Initial_pop<-rlnorm(1,1,0.9)
Spoilage<-7
Growth_spoilage<-Spoilage-Initial_pop
Tempmin<-(-1.19)
b<-.03578
k<-((Temp-Tempmin)*b)^2
Variability<-(1-(rnorm(1,0,17)/100))
New_K<- k *Variability
Conversion<-2^New_K
New_K2<-log10(Conversion)
Shelf_Life<-Growth_spoilage/New_K2
Shelf_Life_days<-Shelf_Life/24
Data_Frame_Milk[i,colnames(Data_Frame_Milk)== "Shelflife"]<-Shelf_Life_days
}
hist(Data_Frame_Milk$Shelflife)
Data_Frame_Milk<-data.frame(
Iteration = 1:500,
Shelflife =as.numeric(0),
stringsAsFactors = FALSE
)
for (i in 1:nrow(Data_Frame_Milk)){
Temp<-rnorm(1,6.5,2)
Initial_pop<-rlnorm(1,1,0.9)
Spoilage<-7
Growth_spoilage<-Spoilage-Initial_pop
Tempmin<-(-1.19)
b<-.03578
k<-((Temp-Tempmin)*b)^2
#Variability<-(1-(rnorm(1,0,17)/100))
New_K<- k *Variability
Conversion<-2^New_K
New_K2<-log10(Conversion)
Shelf_Life<-Growth_spoilage/New_K2
Shelf_Life_days<-Shelf_Life/24
Data_Frame_Milk[i,colnames(Data_Frame_Milk)== "Shelflife"]<-Shelf_Life_days
}
hist(Data_Frame_Milk$Shelflife)
Data_Frame_Milk<-data.frame(
Iteration = 1:500,
Shelflife =as.numeric(0),
stringsAsFactors = FALSE
)
for (i in 1:nrow(Data_Frame_Milk)){
Temp<-rnorm(1,6.5,2)
Initial_pop<-rlnorm(1,1,0.9)
Spoilage<-7
Growth_spoilage<-Spoilage-Initial_pop
Tempmin<-(-1.19)
b<-.03578
k<-((Temp-Tempmin)*b)^2
#Variability<-(1-(rnorm(1,0,17)/100))
New_K<- k #*Variability
Conversion<-2^New_K
New_K2<-log10(Conversion)
Shelf_Life<-Growth_spoilage/New_K2
Shelf_Life_days<-Shelf_Life/24
Data_Frame_Milk[i,colnames(Data_Frame_Milk)== "Shelflife"]<-Shelf_Life_days
}
hist(Data_Frame_Milk$Shelflife)
Growth_spoilage<-Spoilage-Initial_pop
Initial_pop<-rlnorm(1,1,0.9)
Initial_pop<-rlnorm(1,1,0.9)
Initial_pop<-rlnorm(1,1,0.9)
Initial_pop<-rlnorm(1,1,0.9)
Initial_pop<-rlnorm(1,1,0.9)
Initial_pop<-rlnorm(1,1,0.9)
Initial_pop<-rlnorm(1,1,0.9)
Initial_pop<-rlnorm(1,1,0.9)
Initial_pop<-rlnorm(1,1,0.9)
Initial_pop<-rlnorm(1,1,0.9)
Initial_pop<-rlnorm(1,1,0.9)
Initial_pop<-rlnorm(1,1,0.9)
Initial_pop<-rlnorm(1,1,0.9)
for (i in 1:nrow(Data_Frame_Milk)){
Temp<-rnorm(1,6.5,2)
Initial_pop<-rnorm(1,1,0.9)
Spoilage<-7
Growth_spoilage<-Spoilage-Initial_pop
Tempmin<-(-1.19)
b<-.03578
k<-((Temp-Tempmin)*b)^2
#Variability<-(1-(rnorm(1,0,17)/100))
New_K<- k #*Variability
Conversion<-2^New_K
New_K2<-log10(Conversion)
Shelf_Life<-Growth_spoilage/New_K2
Shelf_Life_days<-Shelf_Life/24
Data_Frame_Milk[i,colnames(Data_Frame_Milk)== "Shelflife"]<-Shelf_Life_days
}
hist(Data_Frame_Milk$Shelflife)
Data_Frame_Milk<-data.frame(
Iteration = 1:500,
Shelflife =as.numeric(0),
stringsAsFactors = FALSE
)
for (i in 1:nrow(Data_Frame_Milk)){
Temp<-rnorm(1,6.5,2)
Initial_pop<-rnorm(1,1,0.9)
Spoilage<-7
Growth_spoilage<-Spoilage-Initial_pop
Tempmin<-(-1.19)
b<-.03578
k<-((Temp-Tempmin)*b)^2
Variability<-(1-(rnorm(1,0,17)/100))
New_K<- k *Variability
Conversion<-2^New_K
New_K2<-log10(Conversion)
Shelf_Life<-Growth_spoilage/New_K2
Shelf_Life_days<-Shelf_Life/24
Data_Frame_Milk[i,colnames(Data_Frame_Milk)== "Shelflife"]<-Shelf_Life_days
}
hist(Data_Frame_Milk$Shelflife)
Data_Frame_Milk<-data.frame(
Iteration = 1:500,
Shelflife =as.numeric(0),
stringsAsFactors = FALSE
)
for (i in 1:nrow(Data_Frame_Milk)){
Temp<-rnorm(1,6.5,2)
Initial_pop<-rnorm(1,1,0.9)
Spoilage<-7
Growth_spoilage<-Spoilage-Initial_pop
Tempmin<-(-1.19)
b<-.03578
k<-((Temp-Tempmin)*b)^2
Variability<-(1-(rnorm(1,0,17)/100))
New_K<- k *Variability
Conversion<-2^New_K
New_K2<-log10(Conversion)
Shelf_Life<-Growth_spoilage/New_K2
Shelf_Life_days<-Shelf_Life/24
Data_Frame_Milk[i,colnames(Data_Frame_Milk)== "Shelflife"]<-Shelf_Life_days
}
hist(Data_Frame_Milk$Shelflife)
?hist
hist(Data_Frame_Milk$Shelflife, breaks = 100)
Initial_pop<-rlnorm(500,1,0.9)
hist(Initial_pop)
Initial_pop<-rnorm(500,1,0.9)
hist(Initial_pop)
Initial_pop<-rlnorm(500,1,0.9)
hist(Initial_pop)
Initial_pop<-rlnorm(500,1,0.09)
hist(Initial_pop)
Initial_pop<-rlnorm(500,1,0.9)
hist(Initial_pop)
Data_Frame_Milk<-data.frame(
Iteration = 1:500,
Shelflife =as.numeric(0),
stringsAsFactors = FALSE
)
for (i in 1:nrow(Data_Frame_Milk)){
Temp<-rnorm(1,6.5,2)
Initial_pop<-rlnorm(1,1,0.9)
Spoilage<-7
Growth_spoilage<-Spoilage-Initial_pop
Tempmin<-(-1.19)
b<-.03578
k<-((Temp-Tempmin)*b)^2
Variability<-(1-(rnorm(1,0,17)/100))
New_K<- k *Variability
Conversion<-2^New_K
New_K2<-log10(Conversion)
Shelf_Life<-Growth_spoilage/New_K2
Shelf_Life_days<-Shelf_Life/24
Data_Frame_Milk[i,colnames(Data_Frame_Milk)== "Shelflife"]<-Shelf_Life_days
}
hist(Data_Frame_Milk$Shelflife, breaks = 100)
rlnorm(1,1,0.9)
rlnorm(1,1,0.9)
rlnorm(1,1,0.9)
rlnorm3(500,1,0.9)
Initial_pop<-rlnorm3(500,1,0.9)
hist(Initial_pop)
Initial_pop<-rlnorm(500,1,0.9)
hist(Initial_pop)
Initial_pop<-rlnorm3(500,1,0.9)
hist(Initial_pop)
Surface_hands<- 52  #cm^2
mass_feces_hands<- rbetagen(500,4.57,2.55,-8.00,-1.00) #log(g/hands)
HU_NV_in_Feces<- rlnormTrunc(1,6.65,2.06,0.0,10.98) #log HuNov CG/ g
Hu_NV_restroom<- runif(1,0,2) #log HUNOV/cm2
TE_RH<- rtriang(1,.036,.07,.22)
Genomic_copies_per_PFU<-rnormTrunc(1,3.65,.98,2.00,5.40)
Personal_Contamination<-((10^mass_feces_hands) * (10^HU_NV_in_Feces))/(10^Genomic_copies_per_PFU) #PFU/Hand
Surface_hands<- 52  #cm^2
mass_feces_hands<- rbetagen(1,4.57,2.55,-8.00,-1.00) #log(g/hands)
HU_NV_in_Feces<- rlnormTrunc(1,6.65,2.06,0.0,10.98) #log HuNov CG/ g
Hu_NV_restroom<- runif(1,0,2) #log HUNOV/cm2
TE_RH<- rtriang(1,.036,.07,.22)
Genomic_copies_per_PFU<-rnormTrunc(1,3.65,.98,2.00,5.40)
Personal_Contamination<-((10^mass_feces_hands) * (10^HU_NV_in_Feces))/(10^Genomic_copies_per_PFU) #PFU/Hand
